Function.prototype.bind||(Function.prototype.bind=function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var d=Array.prototype.slice.call(arguments,1),e=this,a=function(){},c=function(){return e.apply(this instanceof a&&b?this:b,d.concat(Array.prototype.slice.call(arguments)))};a.prototype=this.prototype;c.prototype=new a;return c});
"undefined"!==typeof document&&!("classList"in document.createElement("a"))&&function(d){d=(d.HTMLElement||d.Element).prototype;var e=Object,l=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},m=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},g=function(a,b){this.name=a;this.code=DOMException[a];this.message=b},f=function(a,b){if(""===b)throw new g("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new g("INVALID_CHARACTER_ERR",
"String contains an invalid character");return m.call(a,b)},h=function(a){for(var b=l.call(a.className),b=b?b.split(/\s+/):[],c=0,d=b.length;c<d;c++)this.push(b[c]);this._updateClassName=function(){a.className=this.toString()}},c=h.prototype=[],k=function(){return new h(this)};g.prototype=Error.prototype;c.item=function(a){return this[a]||null};c.contains=function(a){return-1!==f(this,a+"")};c.add=function(a){a+="";-1===f(this,a)&&(this.push(a),this._updateClassName())};c.remove=function(a){a=f(this,
a+"");-1!==a&&(this.splice(a,1),this._updateClassName())};c.toggle=function(a){a+="";-1===f(this,a)?this.add(a):this.remove(a)};c.toString=function(){return this.join(" ")};if(e.defineProperty){c={get:k,enumerable:!0,configurable:!0};try{e.defineProperty(d,"classList",c)}catch(n){-2146823252===n.number&&(c.enumerable=!1,e.defineProperty(d,"classList",c))}}else e.prototype.__defineGetter__&&d.__defineGetter__("classList",k)}(self);
window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return window.setTimeout(function(){a(+new Date)},1E3/60)});
var Zepto=function(){function e(a){return null==a?String(a):O[U.call(a)]||"object"}function g(a){return"function"==e(a)}function r(a){return null!=a&&a==a.window}function s(a){return null!=a&&a.nodeType==a.DOCUMENT_NODE}function D(a){return"object"==e(a)}function y(a){return D(a)&&!r(a)&&Object.getPrototypeOf(a)==Object.prototype}function u(a){return a instanceof Array}function C(a){return"number"==typeof a.length}function L(a){return b.call(a,function(a){return null!=a})}function v(a){return a.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function K(a){return a in z?z[a]:z[a]=RegExp("(^|\\s)"+a+"(\\s|$)")}function E(a){return"children"in a?k.call(a.children):f.map(a.childNodes,function(a){if(1==a.nodeType)return a})}function A(a,p,b){for(h in p)b&&(y(p[h])||u(p[h]))?(y(p[h])&&!y(a[h])&&(a[h]={}),u(p[h])&&!u(a[h])&&(a[h]=[]),A(a[h],p[h],b)):p[h]!==m&&(a[h]=p[h])}function F(a,p){return null==p?f(a):f(a).filter(p)}function t(a,
p,b,c){return g(p)?p.call(a,b,c):p}function w(a,p){var b=a.className,c=b&&b.baseVal!==m;if(p===m)return c?b.baseVal:b;c?b.baseVal=p:a.className=p}function x(a){var p;try{return a?"true"==a||("false"==a?!1:"null"==a?null:!/^0/.test(a)&&!isNaN(p=Number(a))?p:/^[\[\{]/.test(a)?f.parseJSON(a):a):a}catch(b){return a}}function H(a,p){p(a);for(var b in a.childNodes)H(a.childNodes[b],p)}var m,h,f,B,d=[],k=d.slice,b=d.filter,c=window.document,n={},z={},J={"column-count":1,columns:1,"font-weight":1,"line-height":1,
opacity:1,"z-index":1,zoom:1},I=/^\s*<(\w+|!)[^>]*>/,V=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,l=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Q=/^(?:body|html)$/i,W=/([A-Z])/g,X="val css html text data width height offset".split(" "),P=c.createElement("table"),R=c.createElement("tr"),S={tr:c.createElement("tbody"),tbody:P,thead:P,tfoot:P,td:R,th:R,"*":c.createElement("div")},Y=/complete|loaded|interactive/,Z=/^[\w-]*$/,O={},U=O.toString,q={},M,N,T=c.createElement("div"),$={tabindex:"tabIndex",
readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};q.matches=function(a,p){if(!p||!a||1!==a.nodeType)return!1;var b=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(b)return b.call(a,p);var c;c=a.parentNode;(b=!c)&&(c=T).appendChild(a);c=~q.qsa(c,p).indexOf(a);b&&T.removeChild(a);
return c};M=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})};N=function(a){return b.call(a,function(b,c){return a.indexOf(b)==c})};q.fragment=function(a,b,G){var d,e,n;V.test(a)&&(d=f(c.createElement(RegExp.$1)));d||(a.replace&&(a=a.replace(l,"<$1></$2>")),b===m&&(b=I.test(a)&&RegExp.$1),b in S||(b="*"),n=S[b],n.innerHTML=""+a,d=f.each(k.call(n.childNodes),function(){n.removeChild(this)}));y(G)&&(e=f(d),f.each(G,function(a,b){if(-1<X.indexOf(a))e[a](b);else e.attr(a,
b)}));return d};q.Z=function(a,b){a=a||[];a.__proto__=f.fn;a.selector=b||"";return a};q.isZ=function(a){return a instanceof q.Z};q.init=function(a,b){var G;if(a)if("string"==typeof a)if(a=a.trim(),"<"==a[0]&&I.test(a))G=q.fragment(a,RegExp.$1,b),a=null;else{if(b!==m)return f(b).find(a);G=q.qsa(c,a)}else{if(g(a))return f(c).ready(a);if(q.isZ(a))return a;if(u(a))G=L(a);else if(D(a))G=[a],a=null;else if(I.test(a))G=q.fragment(a.trim(),RegExp.$1,b),a=null;else{if(b!==m)return f(b).find(a);G=q.qsa(c,a)}}else return q.Z();
return q.Z(G,a)};f=function(a,b){return q.init(a,b)};f.extend=function(a){var b,c=k.call(arguments,1);"boolean"==typeof a&&(b=a,a=c.shift());c.forEach(function(c){A(a,c,b)});return a};q.qsa=function(a,b){var c,d="#"==b[0],e=!d&&"."==b[0],f=d||e?b.slice(1):b,n=Z.test(f);return s(a)&&n&&d?(c=a.getElementById(f))?[c]:[]:1!==a.nodeType&&9!==a.nodeType?[]:k.call(n&&!d?e?a.getElementsByClassName(f):a.getElementsByTagName(b):a.querySelectorAll(b))};f.contains=function(a,b){return a!==b&&a.contains(b)};f.type=
e;f.isFunction=g;f.isWindow=r;f.isArray=u;f.isPlainObject=y;f.isEmptyObject=function(a){for(var b in a)return!1;return!0};f.inArray=function(a,b,c){return d.indexOf.call(b,a,c)};f.camelCase=M;f.trim=function(a){return null==a?"":String.prototype.trim.call(a)};f.uuid=0;f.support={};f.expr={};f.map=function(a,b){var c,d=[],e;if(C(a))for(e=0;e<a.length;e++)c=b(a[e],e),null!=c&&d.push(c);else for(e in a)c=b(a[e],e),null!=c&&d.push(c);return 0<d.length?f.fn.concat.apply([],d):d};f.each=function(a,b){var c;
if(C(a))for(c=0;c<a.length&&!1!==b.call(a[c],c,a[c]);c++);else for(c in a)if(!1===b.call(a[c],c,a[c]))break;return a};f.grep=function(a,c){return b.call(a,c)};window.JSON&&(f.parseJSON=JSON.parse);f.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){O["[object "+b+"]"]=b.toLowerCase()});f.fn={forEach:d.forEach,reduce:d.reduce,push:d.push,sort:d.sort,indexOf:d.indexOf,concat:d.concat,map:function(a){return f(f.map(this,function(b,c){return a.call(b,c,b)}))},
slice:function(){return f(k.apply(this,arguments))},ready:function(a){Y.test(c.readyState)&&c.body?a(f):c.addEventListener("DOMContentLoaded",function(){a(f)},!1);return this},get:function(a){return a===m?k.call(this):this[0<=a?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){d.every.call(this,function(b,c){return!1!==a.call(b,c,b)});
return this},filter:function(a){return g(a)?this.not(this.not(a)):f(b.call(this,function(b){return q.matches(b,a)}))},add:function(a,b){return f(N(this.concat(f(a,b))))},is:function(a){return 0<this.length&&q.matches(this[0],a)},not:function(a){var b=[];if(g(a)&&a.call!==m)this.each(function(c){a.call(this,c)||b.push(this)});else{var c="string"==typeof a?this.filter(a):C(a)&&g(a.item)?k.call(a):f(a);this.forEach(function(a){0>c.indexOf(a)&&b.push(a)})}return f(b)},has:function(a){return this.filter(function(){return D(a)?
f.contains(this,a):f(this).find(a).size()})},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!D(a)?a:f(a)},last:function(){var a=this[this.length-1];return a&&!D(a)?a:f(a)},find:function(a){var b=this;return"object"==typeof a?f(a).filter(function(){var a=this;return d.some.call(b,function(b){return f.contains(b,a)})}):1==this.length?f(q.qsa(this[0],a)):this.map(function(){return q.qsa(this,a)})},closest:function(a,b){var c=this[0],d=!1;for("object"==
typeof a&&(d=f(a));c&&!(d?0<=d.indexOf(c):q.matches(c,a));)c=c!==b&&!s(c)&&c.parentNode;return f(c)},parents:function(a){for(var b=[],c=this;0<c.length;)c=f.map(c,function(a){if((a=a.parentNode)&&!s(a)&&0>b.indexOf(a))return b.push(a),a});return F(b,a)},parent:function(a){return F(N(this.pluck("parentNode")),a)},children:function(a){return F(this.map(function(){return E(this)}),a)},contents:function(){return this.map(function(){return k.call(this.childNodes)})},siblings:function(a){return F(this.map(function(a,
c){return b.call(E(c.parentNode),function(a){return a!==c})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return f.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display="");if("none"==getComputedStyle(this,"").getPropertyValue("display")){var a=this.style,b=this.nodeName,d,e;n[b]||(d=c.createElement(b),c.body.appendChild(d),e=getComputedStyle(d,"").getPropertyValue("display"),d.parentNode.removeChild(d),
"none"==e&&(e="block"),n[b]=e);a.display=n[b]}})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var b=g(a);if(this[0]&&!b)var c=f(a).get(0),d=c.parentNode||1<this.length;return this.each(function(e){f(this).wrapAll(b?a.call(this,e):d?c.cloneNode(!0):c)})},wrapAll:function(a){if(this[0]){f(this[0]).before(a=f(a));for(var b;(b=a.children()).length;)a=b.first();f(a).append(this)}return this},wrapInner:function(a){var b=g(a);return this.each(function(c){var d=f(this),e=d.contents();
c=b?a.call(this,c):a;e.length?e.wrapAll(c):d.append(c)})},unwrap:function(){this.parent().each(function(){f(this).replaceWith(f(this).children())});return this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=f(this);(a===m?"none"==b.css("display"):a)?b.show():b.hide()})},prev:function(a){return f(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return f(this.pluck("nextElementSibling")).filter(a||
"*")},html:function(a){return 0===arguments.length?0<this.length?this[0].innerHTML:null:this.each(function(b){var c=this.innerHTML;f(this).empty().append(t(this,a,b,c))})},text:function(a){return 0===arguments.length?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=a===m?"":""+a})},attr:function(a,b){var c;return"string"==typeof a&&b===m?0==this.length||1!==this[0].nodeType?m:"value"==a&&"INPUT"==this[0].nodeName?this.val():!(c=this[0].getAttribute(a))&&a in this[0]?this[0][a]:
c:this.each(function(c){if(1===this.nodeType)if(D(a))for(h in a){c=h;var d=a[h];null==d?this.removeAttribute(c):this.setAttribute(c,d)}else c=t(this,b,c,this.getAttribute(a)),null==c?this.removeAttribute(a):this.setAttribute(a,c)})},removeAttr:function(a){return this.each(function(){1===this.nodeType&&this.removeAttribute(a)})},prop:function(a,b){a=$[a]||a;return b===m?this[0]&&this[0][a]:this.each(function(c){this[a]=t(this,b,c,this[a])})},data:function(a,b){var c=this.attr("data-"+a.replace(W,"-$1").toLowerCase(),
b);return null!==c?x(c):m},val:function(a){return 0===arguments.length?this[0]&&(this[0].multiple?f(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(b){this.value=t(this,a,b,this.value)})},offset:function(a){if(a)return this.each(function(b){var c=f(this);b=t(this,a,b,c.offset());var d=c.offsetParent().offset();b={top:b.top-d.top,left:b.left-d.left};"static"==c.css("position")&&(b.position="relative");c.css(b)});if(0==this.length)return null;
var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(a,b){if(2>arguments.length){var c=this[0],d=getComputedStyle(c,"");if(!c)return;if("string"==typeof a)return c.style[M(a)]||d.getPropertyValue(a);if(u(a)){var k={};f.each(u(a)?a:[a],function(a,b){k[b]=c.style[M(b)]||d.getPropertyValue(b)});return k}}var n="";if("string"==e(a))!b&&0!==b?this.each(function(){this.style.removeProperty(v(a))}):
n=v(a)+":"+("number"==typeof b&&!J[v(a)]?b+"px":b);else for(h in a)!a[h]&&0!==a[h]?this.each(function(){this.style.removeProperty(v(h))}):n+=v(h)+":"+("number"==typeof a[h]&&!J[v(h)]?a[h]+"px":a[h])+";";return this.each(function(){this.style.cssText+=";"+n})},index:function(a){return a?this.indexOf(f(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return!a?!1:d.some.call(this,function(a){return this.test(w(a))},K(a))},addClass:function(a){return!a?this:this.each(function(b){B=
[];var c=w(this);t(this,a,b,c).split(/\s+/g).forEach(function(a){f(this).hasClass(a)||B.push(a)},this);B.length&&w(this,c+(c?" ":"")+B.join(" "))})},removeClass:function(a){return this.each(function(b){if(a===m)return w(this,"");B=w(this);t(this,a,b,B).split(/\s+/g).forEach(function(a){B=B.replace(K(a)," ")});w(this,B.trim())})},toggleClass:function(a,b){return!a?this:this.each(function(c){var d=f(this);t(this,a,c,w(this)).split(/\s+/g).forEach(function(a){(b===m?!d.hasClass(a):b)?d.addClass(a):d.removeClass(a)})})},
scrollTop:function(a){if(this.length){var b="scrollTop"in this[0];return a===m?b?this[0].scrollTop:this[0].pageYOffset:this.each(b?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,a)})}},scrollLeft:function(a){if(this.length){var b="scrollLeft"in this[0];return a===m?b?this[0].scrollLeft:this[0].pageXOffset:this.each(b?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),c=this.offset(),
d=Q.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f(a).css("margin-top"))||0;c.left-=parseFloat(f(a).css("margin-left"))||0;d.top+=parseFloat(f(b[0]).css("border-top-width"))||0;d.left+=parseFloat(f(b[0]).css("border-left-width"))||0;return{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||c.body;a&&!Q.test(a.nodeName)&&"static"==f(a).css("position");)a=a.offsetParent;return a})}};f.fn.detach=f.fn.remove;["width",
"height"].forEach(function(a){var b=a.replace(/./,function(a){return a[0].toUpperCase()});f.fn[a]=function(c){var d,e=this[0];return c===m?r(e)?e["inner"+b]:s(e)?e.documentElement["scroll"+b]:(d=this.offset())&&d[a]:this.each(function(b){e=f(this);e.css(a,t(this,c,b,e[a]()))})}});["after","prepend","before","append"].forEach(function(a,b){var c=b%2;f.fn[a]=function(){var a,d=f.map(arguments,function(b){a=e(b);return"object"==a||"array"==a||null==b?b:q.fragment(b)}),k,n=1<this.length;return 1>d.length?
this:this.each(function(a,e){k=c?e:e.parentNode;e=0==b?e.nextSibling:1==b?e.firstChild:2==b?e:null;d.forEach(function(a){if(n)a=a.cloneNode(!0);else if(!k)return f(a).remove();H(k.insertBefore(a,e),function(a){null!=a.nodeName&&("SCRIPT"===a.nodeName.toUpperCase()&&(!a.type||"text/javascript"===a.type)&&!a.src)&&window.eval.call(window,a.innerHTML)})})})};f.fn[c?a+"To":"insert"+(b?"Before":"After")]=function(b){f(b)[a](this);return this}});q.Z.prototype=f.fn;q.uniq=N;q.deserializeValue=x;f.zepto=
q;return f}();window.Zepto=Zepto;void 0===window.$&&(window.$=Zepto);
(function(e){function g(d){return d._zid||(d._zid=L++)}function r(d,e,b,c){e=s(e);if(e.ns)var f=RegExp("(?:^| )"+e.ns.replace(" "," .* ?")+"(?: |$)");return(F[g(d)]||[]).filter(function(d){return d&&(!e.e||d.e==e.e)&&(!e.ns||f.test(d.ns))&&(!b||g(d.fn)===g(b))&&(!c||d.sel==c)})}function s(d){d=(""+d).split(".");return{e:d[0],ns:d.slice(1).sort().join(" ")}}function D(d,f,b,c,n,z,J){var I=g(d),h=F[I]||(F[I]=[]);f.split(/\s/).forEach(function(f){if("ready"==f)return e(document).ready(b);var k=s(f);
k.fn=b;k.sel=n;k.e in H&&(b=function(b){var c=b.relatedTarget;if(!c||c!==this&&!e.contains(this,c))return k.fn.apply(this,arguments)});var I=(k.del=z)||b;k.proxy=function(b){b=u(b);if(!b.isImmediatePropagationStopped()){b.data=c;var e=I.apply(d,b._args==v?[b]:[b].concat(b._args));!1===e&&(b.preventDefault(),b.stopPropagation());return e}};k.i=h.length;h.push(k);"addEventListener"in d&&d.addEventListener(H[k.e]||w&&x[k.e]||k.e,k.proxy,k.del&&!w&&k.e in x||!!J)})}function y(d,e,b,c,f){var z=g(d);(e||
"").split(/\s/).forEach(function(e){r(d,e,b,c).forEach(function(b){delete F[z][b.i];"removeEventListener"in d&&d.removeEventListener(H[b.e]||w&&x[b.e]||b.e,b.proxy,b.del&&!w&&b.e in x||!!f)})})}function u(d,f){if(f||!d.isDefaultPrevented)if(f||(f=d),e.each(B,function(b,c){var e=f[b];d[b]=function(){this[c]=m;return e&&e.apply(f,arguments)};d[c]=h}),f.defaultPrevented!==v?f.defaultPrevented:"returnValue"in f?!1===f.returnValue:f.getPreventDefault&&f.getPreventDefault())d.isDefaultPrevented=m;return d}
function C(d){var e,b={originalEvent:d};for(e in d)!f.test(e)&&d[e]!==v&&(b[e]=d[e]);return u(b,d)}var L=1,v,K=Array.prototype.slice,E=e.isFunction,A=function(d){return"string"==typeof d},F={},t={},w="onfocusin"in window,x={focus:"focusin",blur:"focusout"},H={mouseenter:"mouseover",mouseleave:"mouseout"};t.click=t.mousedown=t.mouseup=t.mousemove="MouseEvents";e.event={add:D,remove:y};e.proxy=function(d,f){if(E(d)){var b=function(){return d.apply(f,arguments)};b._zid=g(d);return b}if(A(f))return e.proxy(d[f],
d);throw new TypeError("expected function");};e.fn.bind=function(d,e,b){return this.on(d,e,b)};e.fn.unbind=function(d,e){return this.off(d,e)};e.fn.one=function(d,e,b,c){return this.on(d,e,b,c,1)};var m=function(){return!0},h=function(){return!1},f=/^([A-Z]|returnValue$|layer[XY]$)/,B={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(d,e,b){return this.on(e,d,b)};e.fn.undelegate=function(d,e,
b){return this.off(e,d,b)};e.fn.live=function(d,f){e(document.body).delegate(this.selector,d,f);return this};e.fn.die=function(d,f){e(document.body).undelegate(this.selector,d,f);return this};e.fn.on=function(d,f,b,c,n){var z,J,g=this;if(d&&!A(d))return e.each(d,function(c,d){g.on(c,f,b,d,n)}),g;!A(f)&&(!E(c)&&!1!==c)&&(c=b,b=f,f=v);if(E(b)||!1===b)c=b,b=v;!1===c&&(c=h);return g.each(function(g,l){n&&(z=function(b){y(l,b.type,c);return c.apply(this,arguments)});f&&(J=function(b){var d,n=e(b.target).closest(f,
l).get(0);if(n&&n!==l)return d=e.extend(C(b),{currentTarget:n,liveFired:l}),(z||c).apply(n,[d].concat(K.call(arguments,1)))});D(l,d,c,b,f,J||z)})};e.fn.off=function(d,f,b){var c=this;if(d&&!A(d))return e.each(d,function(b,d){c.off(b,f,d)}),c;!A(f)&&(!E(b)&&!1!==b)&&(b=f,f=v);!1===b&&(b=h);return c.each(function(){y(this,d,b,f)})};e.fn.trigger=function(d,f){d=A(d)||e.isPlainObject(d)?e.Event(d):u(d);d._args=f;return this.each(function(){"dispatchEvent"in this?this.dispatchEvent(d):e(this).triggerHandler(d,
f)})};e.fn.triggerHandler=function(d,f){var b,c;this.each(function(n,z){b=C(A(d)?e.Event(d):d);b._args=f;b.target=z;e.each(r(z,d.type||d),function(d,e){c=e.proxy(b);if(b.isImmediatePropagationStopped())return!1})});return c};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(d){e.fn[d]=function(e){return e?this.bind(d,e):this.trigger(d)}});["focus","blur"].forEach(function(d){e.fn[d]=
function(e){e?this.bind(d,e):this.each(function(){try{this[d]()}catch(b){}});return this}});e.Event=function(d,e){A(d)||(e=d,d=e.type);var b=document.createEvent(t[d]||"Events"),c=!0;if(e)for(var f in e)"bubbles"==f?c=!!e[f]:b[f]=e[f];b.initEvent(d,c,!0);return u(b)}})(Zepto);
(function(e){function g(b,c,d,f){if(b.global)return b=c||t,d=e.Event(d),e(b).trigger(d,f),!d.isDefaultPrevented()}function r(b){b.global&&0===e.active++&&g(b,null,"ajaxStart")}function s(b,c){var d=c.context;if(!1===c.beforeSend.call(d,b,c)||!1===g(c,d,"ajaxBeforeSend",[b,c]))return!1;g(c,d,"ajaxSend",[b,c])}function D(b,c,d,e){var f=d.context;d.success.call(f,b,"success",c);e&&e.resolveWith(f,[b,"success",c]);g(d,f,"ajaxSuccess",[c,d,b]);u("success",c,d)}function y(b,c,d,e,f){var h=e.context;e.error.call(h,
d,c,b);f&&f.rejectWith(h,[d,c,b]);g(e,h,"ajaxError",[d,e,b||c]);u(c,d,e)}function u(b,c,d){var f=d.context;d.complete.call(f,c,b);g(d,f,"ajaxComplete",[c,d]);d.global&&!--e.active&&g(d,null,"ajaxStop")}function C(){}function L(b){b&&(b=b.split(";",2)[0]);return b&&(b==B?"html":b==f?"json":m.test(b)?"script":h.test(b)&&"xml")||"text"}function v(b,c){return""==c?b:(b+"&"+c).replace(/[&?]{1,2}/,"?")}function K(b){b.processData&&(b.data&&"string"!=e.type(b.data))&&(b.data=e.param(b.data,b.traditional));
if(b.data&&(!b.type||"GET"==b.type.toUpperCase()))b.url=v(b.url,b.data),b.data=void 0}function E(b,c,d,f){var g=!e.isFunction(c);return{url:b,data:g?c:void 0,success:!g?c:e.isFunction(d)?d:void 0,dataType:g?f||d:d}}function A(b,c,d,f){var g,h=e.isArray(c),k=e.isPlainObject(c);e.each(c,function(c,s){g=e.type(s);f&&(c=d?f:f+"["+(k||"object"==g||"array"==g?c:"")+"]");!f&&h?b.add(s.name,s.value):"array"==g||!d&&"object"==g?A(b,s,d,c):b.add(c,s)})}var F=0,t=window.document,w,x,H=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
m=/^(?:text|application)\/javascript/i,h=/^(?:text|application)\/xml/i,f="application/json",B="text/html",d=/^\s*$/;e.active=0;e.ajaxJSONP=function(b,c){if(!("type"in b))return e.ajax(b);var d=b.jsonpCallback,f=(e.isFunction(d)?d():d)||"jsonp"+ ++F,g=t.createElement("script"),h=window[f],k,l=function(b){e(g).triggerHandler("error",b||"abort")},m={abort:l},r;c&&c.promise(m);e(g).on("load error",function(d,n){clearTimeout(r);e(g).off().remove();"error"==d.type||!k?y(null,n||"error",m,b,c):D(k[0],m,
b,c);window[f]=h;k&&e.isFunction(h)&&h(k[0]);h=k=void 0});if(!1===s(m,b))return l("abort"),m;window[f]=function(){k=arguments};g.src=b.url.replace(/=\?/,"="+f);t.head.appendChild(g);0<b.timeout&&(r=setTimeout(function(){l("timeout")},b.timeout));return m};e.ajaxSettings={type:"GET",beforeSend:C,success:C,error:C,complete:C,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:f,xml:"application/xml, text/xml",
html:B,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};e.ajax=function(b){var c=e.extend({},b||{}),f=e.Deferred&&e.Deferred();for(w in e.ajaxSettings)void 0===c[w]&&(c[w]=e.ajaxSettings[w]);r(c);c.crossDomain||(c.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(c.url)&&RegExp.$2!=window.location.host);c.url||(c.url=window.location.toString());K(c);!1===c.cache&&(c.url=v(c.url,"_="+Date.now()));var g=c.dataType;b=/=\?/.test(c.url);if("jsonp"==g||b)return b||(c.url=v(c.url,c.jsonp?c.jsonp+
"=?":!1===c.jsonp?"":"callback=?")),e.ajaxJSONP(c,f);b=c.accepts[g];var h={},k=function(b,c){h[b.toLowerCase()]=[b,c]},m=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:window.location.protocol,l=c.xhr(),t=l.setRequestHeader,u;f&&f.promise(l);c.crossDomain||k("X-Requested-With","XMLHttpRequest");k("Accept",b||"*/*");if(b=c.mimeType||b)-1<b.indexOf(",")&&(b=b.split(",",2)[0]),l.overrideMimeType&&l.overrideMimeType(b);if(c.contentType||!1!==c.contentType&&c.data&&"GET"!=c.type.toUpperCase())k("Content-Type",
c.contentType||"application/x-www-form-urlencoded");if(c.headers)for(x in c.headers)k(x,c.headers[x]);l.setRequestHeader=k;l.onreadystatechange=function(){if(4==l.readyState){l.onreadystatechange=C;clearTimeout(u);var b,h=!1;if(200<=l.status&&300>l.status||304==l.status||0==l.status&&"file:"==m){g=g||L(c.mimeType||l.getResponseHeader("content-type"));b=l.responseText;try{"script"==g?(0,eval)(b):"xml"==g?b=l.responseXML:"json"==g&&(b=d.test(b)?null:e.parseJSON(b))}catch(k){h=k}h?y(h,"parsererror",
l,c,f):D(b,l,c,f)}else y(l.statusText||null,l.status?"error":"abort",l,c,f)}};if(!1===s(l,c))return l.abort(),y(null,"abort",l,c,f),l;if(c.xhrFields)for(x in c.xhrFields)l[x]=c.xhrFields[x];l.open(c.type,c.url,"async"in c?c.async:!0,c.username,c.password);for(x in h)t.apply(l,h[x]);0<c.timeout&&(u=setTimeout(function(){l.onreadystatechange=C;l.abort();y(null,"timeout",l,c,f)},c.timeout));l.send(c.data?c.data:null);return l};e.get=function(b,c,d,f){return e.ajax(E.apply(null,arguments))};e.post=function(b,
c,d,f){var g=E.apply(null,arguments);g.type="POST";return e.ajax(g)};e.getJSON=function(b,c,d){var f=E.apply(null,arguments);f.dataType="json";return e.ajax(f)};e.fn.load=function(b,c,d){if(!this.length)return this;var f=this,g=b.split(/\s/),h;b=E(b,c,d);var k=b.success;1<g.length&&(b.url=g[0],h=g[1]);b.success=function(b){f.html(h?e("<div>").html(b.replace(H,"")).find(h):b);k&&k.apply(f,arguments)};e.ajax(b);return this};var k=encodeURIComponent;e.param=function(b,c){var d=[];d.add=function(b,c){this.push(k(b)+
"="+k(c))};A(d,b,c);return d.join("&").replace(/%20/g,"+")}})(Zepto);
(function(e){e.fn.serializeArray=function(){var g=[],r;e([].slice.call(this.get(0).elements)).each(function(){r=e(this);var s=r.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&(!this.disabled&&"submit"!=s&&"reset"!=s&&"button"!=s&&("radio"!=s&&"checkbox"!=s||this.checked))&&g.push({name:r.attr("name"),value:r.val()})});return g};e.fn.serialize=function(){var e=[];this.serializeArray().forEach(function(r){e.push(encodeURIComponent(r.name)+"="+encodeURIComponent(r.value))});return e.join("&")};
e.fn.submit=function(g){g?this.bind("submit",g):this.length&&(g=e.Event("submit"),this.eq(0).trigger(g),g.isDefaultPrevented()||this.get(0).submit());return this}})(Zepto);(function(e){"__proto__"in{}||e.extend(e.zepto,{Z:function(g,r){g=g||[];e.extend(g,e.fn);g.selector=r||"";g.__Z=!0;return g},isZ:function(g){return"array"===e.type(g)&&"__Z"in g}});try{getComputedStyle(void 0)}catch(g){var r=getComputedStyle;window.getComputedStyle=function(e){try{return r(e)}catch(g){return null}}}})(Zepto);
(function(){var v=this,O=v._,r={},m=Array.prototype,s=Object.prototype,C=m.push,k=m.slice,t=m.concat,p=s.toString,P=s.hasOwnProperty,D=m.forEach,E=m.map,F=m.reduce,G=m.reduceRight,H=m.filter,I=m.every,J=m.some,u=m.indexOf,K=m.lastIndexOf,s=Array.isArray,L=Object.keys,w=Function.prototype.bind,b=function(a){if(a instanceof b)return a;if(!(this instanceof b))return new b(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=b),exports._=
b):v._=b;b.VERSION="1.6.0";var l=b.each=b.forEach=function(a,d,c){if(null==a)return a;if(D&&a.forEach===D)a.forEach(d,c);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(d.call(c,a[e],e,a)===r)return}else for(var g=b.keys(a),e=0,f=g.length;e<f;e++)if(d.call(c,a[g[e]],g[e],a)===r)return;return a};b.map=b.collect=function(a,d,b){var e=[];if(null==a)return e;if(E&&a.map===E)return a.map(d,b);l(a,function(a,g,h){e.push(d.call(b,a,g,h))});return e};b.reduce=b.foldl=b.inject=function(a,d,
c,e){var f=2<arguments.length;null==a&&(a=[]);if(F&&a.reduce===F)return e&&(d=b.bind(d,e)),f?a.reduce(d,c):a.reduce(d);l(a,function(a,b,n){f?c=d.call(e,c,a,b,n):(c=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};b.reduceRight=b.foldr=function(a,d,c,e){var f=2<arguments.length;null==a&&(a=[]);if(G&&a.reduceRight===G)return e&&(d=b.bind(d,e)),f?a.reduceRight(d,c):a.reduceRight(d);var g=a.length;if(g!==+g)var h=b.keys(a),g=h.length;l(a,function(b,k,l){k=h?
h[--g]:--g;f?c=d.call(e,c,a[k],k,l):(c=a[k],f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};b.find=b.detect=function(a,d,b){var e;M(a,function(a,g,h){if(d.call(b,a,g,h))return e=a,!0});return e};b.filter=b.select=function(a,d,b){var e=[];if(null==a)return e;if(H&&a.filter===H)return a.filter(d,b);l(a,function(a,g,h){d.call(b,a,g,h)&&e.push(a)});return e};b.reject=function(a,d,c){return b.filter(a,function(a,b,g){return!d.call(c,a,b,g)},c)};b.every=b.all=
function(a,d,c){d||(d=b.identity);var e=!0;if(null==a)return e;if(I&&a.every===I)return a.every(d,c);l(a,function(a,b,h){if(!(e=e&&d.call(c,a,b,h)))return r});return!!e};var M=b.some=b.any=function(a,d,c){d||(d=b.identity);var e=!1;if(null==a)return e;if(J&&a.some===J)return a.some(d,c);l(a,function(a,b,h){if(e||(e=d.call(c,a,b,h)))return r});return!!e};b.contains=b.include=function(a,d){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(d):M(a,function(a){return a===d})};b.invoke=function(a,d){var c=
k.call(arguments,2),e=b.isFunction(d);return b.map(a,function(a){return(e?d:a[d]).apply(a,c)})};b.pluck=function(a,d){return b.map(a,b.property(d))};b.where=function(a,d){return b.filter(a,b.matches(d))};b.findWhere=function(a,d){return b.find(a,b.matches(d))};b.max=function(a,d,c){if(!d&&b.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);var e=-Infinity,f=-Infinity;l(a,function(a,b,n){b=d?d.call(c,a,b,n):a;b>f&&(e=a,f=b)});return e};b.min=function(a,d,c){if(!d&&b.isArray(a)&&
a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);var e=Infinity,f=Infinity;l(a,function(a,b,n){b=d?d.call(c,a,b,n):a;b<f&&(e=a,f=b)});return e};b.shuffle=function(a){var d,c=0,e=[];l(a,function(a){d=b.random(c++);e[c-1]=e[d];e[d]=a});return e};b.sample=function(a,d,c){return null==d||c?(a.length!==+a.length&&(a=b.values(a)),a[b.random(a.length-1)]):b.shuffle(a).slice(0,Math.max(0,d))};var x=function(a){return null==a?b.identity:b.isFunction(a)?a:b.property(a)};b.sortBy=function(a,d,c){d=
x(d);return b.pluck(b.map(a,function(a,b,g){return{value:a,index:b,criteria:d.call(c,a,b,g)}}).sort(function(a,d){var b=a.criteria,c=d.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(b<c||void 0===c)return-1}return a.index-d.index}),"value")};var y=function(a){return function(d,b,e){var f={};b=x(b);l(d,function(g,h){var n=b.call(e,g,h,d);a(f,n,g)});return f}};b.groupBy=y(function(a,d,c){b.has(a,d)?a[d].push(c):a[d]=[c]});b.indexBy=y(function(a,b,c){a[b]=c});b.countBy=y(function(a,d){b.has(a,d)?
a[d]++:a[d]=1});b.sortedIndex=function(a,b,c,e){c=x(c);b=c.call(e,b);for(var f=0,g=a.length;f<g;){var h=f+g>>>1;c.call(e,a[h])<b?f=h+1:g=h}return f};b.toArray=function(a){return!a?[]:b.isArray(a)?k.call(a):a.length===+a.length?b.map(a,b.identity):b.values(a)};b.size=function(a){return null==a?0:a.length===+a.length?a.length:b.keys(a).length};b.first=b.head=b.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:k.call(a,0,b)};b.initial=function(a,b,c){return k.call(a,0,a.length-(null==
b||c?1:b))};b.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:k.call(a,Math.max(a.length-b,0))};b.rest=b.tail=b.drop=function(a,b,c){return k.call(a,null==b||c?1:b)};b.compact=function(a){return b.filter(a,b.identity)};var N=function(a,d,c){if(d&&b.every(a,b.isArray))return t.apply(c,a);l(a,function(a){b.isArray(a)||b.isArguments(a)?d?C.apply(c,a):N(a,d,c):c.push(a)});return c};b.flatten=function(a,b){return N(a,b,[])};b.without=function(a){return b.difference(a,k.call(arguments,
1))};b.partition=function(a,b){var c=[],e=[];l(a,function(a){(b(a)?c:e).push(a)});return[c,e]};b.uniq=b.unique=function(a,d,c,e){b.isFunction(d)&&(e=c,c=d,d=!1);c=c?b.map(a,c,e):a;var f=[],g=[];l(c,function(c,e){if(d?!e||g[g.length-1]!==c:!b.contains(g,c))g.push(c),f.push(a[e])});return f};b.union=function(){return b.uniq(b.flatten(arguments,!0))};b.intersection=function(a){var d=k.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(d,function(d){return b.contains(d,a)})})};b.difference=
function(a){var d=t.apply(m,k.call(arguments,1));return b.filter(a,function(a){return!b.contains(d,a)})};b.zip=function(){for(var a=b.max(b.pluck(arguments,"length").concat(0)),d=Array(a),c=0;c<a;c++)d[c]=b.pluck(arguments,""+c);return d};b.object=function(a,b){if(null==a)return{};for(var c={},e=0,f=a.length;e<f;e++)b?c[a[e]]=b[e]:c[a[e][0]]=a[e][1];return c};b.indexOf=function(a,d,c){if(null==a)return-1;var e=0,f=a.length;if(c)if("number"==typeof c)e=0>c?Math.max(0,f+c):c;else return e=b.sortedIndex(a,
d),a[e]===d?e:-1;if(u&&a.indexOf===u)return a.indexOf(d,c);for(;e<f;e++)if(a[e]===d)return e;return-1};b.lastIndexOf=function(a,b,c){if(null==a)return-1;var e=null!=c;if(K&&a.lastIndexOf===K)return e?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=e?c:a.length;c--;)if(a[c]===b)return c;return-1};b.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var e=Math.max(Math.ceil((b-a)/c),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=c;return g};var z=function(){};b.bind=function(a,d){var c,e;if(w&&
a.bind===w)return w.apply(a,k.call(arguments,1));if(!b.isFunction(a))throw new TypeError;c=k.call(arguments,2);return e=function(){if(!(this instanceof e))return a.apply(d,c.concat(k.call(arguments)));z.prototype=a.prototype;var b=new z;z.prototype=null;var g=a.apply(b,c.concat(k.call(arguments)));return Object(g)===g?g:b}};b.partial=function(a){var d=k.call(arguments,1);return function(){for(var c=0,e=d.slice(),f=0,g=e.length;f<g;f++)e[f]===b&&(e[f]=arguments[c++]);for(;c<arguments.length;)e.push(arguments[c++]);
return a.apply(this,e)}};b.bindAll=function(a){var d=k.call(arguments,1);if(0===d.length)throw Error("bindAll must be passed function names");l(d,function(d){a[d]=b.bind(a[d],a)});return a};b.memoize=function(a,d){var c={};d||(d=b.identity);return function(){var e=d.apply(this,arguments);return b.has(c,e)?c[e]:c[e]=a.apply(this,arguments)}};b.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(k.call(arguments,
1)))};b.throttle=function(a,d,c){var e,f,g,h=null,n=0;c||(c={});var k=function(){n=!1===c.leading?0:b.now();h=null;g=a.apply(e,f);e=f=null};return function(){var l=b.now();!n&&!1===c.leading&&(n=l);var m=d-(l-n);e=this;f=arguments;0>=m?(clearTimeout(h),h=null,n=l,g=a.apply(e,f),e=f=null):!h&&!1!==c.trailing&&(h=setTimeout(k,m));return g}};b.debounce=function(a,d,c){var e,f,g,h,k,l=function(){var m=b.now()-h;m<d?e=setTimeout(l,d-m):(e=null,c||(k=a.apply(g,f),g=f=null))};return function(){g=this;f=
arguments;h=b.now();var m=c&&!e;e||(e=setTimeout(l,d));m&&(k=a.apply(g,f),g=f=null);return k}};b.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};b.wrap=function(a,d){return b.partial(d,a)};b.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};b.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};b.keys=function(a){if(!b.isObject(a))return[];
if(L)return L(a);var d=[],c;for(c in a)b.has(a,c)&&d.push(c);return d};b.values=function(a){for(var d=b.keys(a),c=d.length,e=Array(c),f=0;f<c;f++)e[f]=a[d[f]];return e};b.pairs=function(a){for(var d=b.keys(a),c=d.length,e=Array(c),f=0;f<c;f++)e[f]=[d[f],a[d[f]]];return e};b.invert=function(a){for(var d={},c=b.keys(a),e=0,f=c.length;e<f;e++)d[a[c[e]]]=c[e];return d};b.functions=b.methods=function(a){var d=[],c;for(c in a)b.isFunction(a[c])&&d.push(c);return d.sort()};b.extend=function(a){l(k.call(arguments,
1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};b.pick=function(a){var b={},c=t.apply(m,k.call(arguments,1));l(c,function(c){c in a&&(b[c]=a[c])});return b};b.omit=function(a){var d={},c=t.apply(m,k.call(arguments,1)),e;for(e in a)b.contains(c,e)||(d[e]=a[e]);return d};b.defaults=function(a){l(k.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])});return a};b.clone=function(a){return!b.isObject(a)?a:b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);
return a};var A=function(a,d,c,e){if(a===d)return 0!==a||1/a==1/d;if(null==a||null==d)return a===d;a instanceof b&&(a=a._wrapped);d instanceof b&&(d=d._wrapped);var f=p.call(a);if(f!=p.call(d))return!1;switch(f){case "[object String]":return a==String(d);case "[object Number]":return a!=+a?d!=+d:0==a?1/a==1/d:a==+d;case "[object Date]":case "[object Boolean]":return+a==+d;case "[object RegExp]":return a.source==d.source&&a.global==d.global&&a.multiline==d.multiline&&a.ignoreCase==d.ignoreCase}if("object"!=
typeof a||"object"!=typeof d)return!1;for(var g=c.length;g--;)if(c[g]==a)return e[g]==d;var g=a.constructor,h=d.constructor;if(g!==h&&(!b.isFunction(g)||!(g instanceof g&&b.isFunction(h)&&h instanceof h))&&"constructor"in a&&"constructor"in d)return!1;c.push(a);e.push(d);g=0;h=!0;if("[object Array]"==f){if(g=a.length,h=g==d.length)for(;g--&&(h=A(a[g],d[g],c,e)););}else{for(var k in a)if(b.has(a,k)&&(g++,!(h=b.has(d,k)&&A(a[k],d[k],c,e))))break;if(h){for(k in d)if(b.has(d,k)&&!g--)break;h=!g}}c.pop();
e.pop();return h};b.isEqual=function(a,b){return A(a,b,[],[])};b.isEmpty=function(a){if(null==a)return!0;if(b.isArray(a)||b.isString(a))return 0===a.length;for(var d in a)if(b.has(a,d))return!1;return!0};b.isElement=function(a){return!!(a&&1===a.nodeType)};b.isArray=s||function(a){return"[object Array]"==p.call(a)};b.isObject=function(a){return a===Object(a)};l("Arguments Function String Number Date RegExp".split(" "),function(a){b["is"+a]=function(b){return p.call(b)=="[object "+a+"]"}});b.isArguments(arguments)||
(b.isArguments=function(a){return!(!a||!b.has(a,"callee"))});"function"!==typeof/./&&(b.isFunction=function(a){return"function"===typeof a});b.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};b.isNaN=function(a){return b.isNumber(a)&&a!=+a};b.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==p.call(a)};b.isNull=function(a){return null===a};b.isUndefined=function(a){return void 0===a};b.has=function(a,b){return P.call(a,b)};b.noConflict=function(){v._=O;return this};b.identity=
function(a){return a};b.constant=function(a){return function(){return a}};b.property=function(a){return function(b){return b[a]}};b.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}};b.times=function(a,b,c){for(var e=Array(Math.max(0,a)),f=0;f<a;f++)e[f]=b.call(c,f);return e};b.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};b.now=Date.now||function(){return(new Date).getTime()};var q={escape:{"&":"&amp;",
"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};q.unescape=b.invert(q.escape);var Q={escape:RegExp("["+b.keys(q.escape).join("")+"]","g"),unescape:RegExp("("+b.keys(q.unescape).join("|")+")","g")};b.each(["escape","unescape"],function(a){b[a]=function(b){return null==b?"":(""+b).replace(Q[a],function(b){return q[a][b]})}});b.result=function(a,d){if(null!=a){var c=a[d];return b.isFunction(c)?c.call(a):c}};b.mixin=function(a){l(b.functions(a),function(d){var c=b[d]=a[d];b.prototype[d]=function(){var a=
[this._wrapped];C.apply(a,arguments);a=c.apply(b,a);return this._chain?b(a).chain():a}})};var R=0;b.uniqueId=function(a){var b=++R+"";return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,S={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},T=/\\|'|\r|\n|\t|\u2028|\u2029/g;b.template=function(a,d,c){var e;c=b.defaults({},c,b.templateSettings);var f=RegExp([(c.escape||B).source,(c.interpolate||
B).source,(c.evaluate||B).source].join("|")+"|$","g"),g=0,h="__p+='";a.replace(f,function(b,c,d,e,f){h+=a.slice(g,f).replace(T,function(a){return"\\"+S[a]});c&&(h+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");d&&(h+="'+\n((__t=("+d+"))==null?'':__t)+\n'");e&&(h+="';\n"+e+"\n__p+='");g=f+b.length;return b});h+="';\n";c.variable||(h="with(obj||{}){\n"+h+"}\n");h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{e=new Function(c.variable||
"obj","_",h)}catch(k){throw k.source=h,k;}if(d)return e(d,b);d=function(a){return e.call(this,a,b)};d.source="function("+(c.variable||"obj")+"){\n"+h+"}";return d};b.chain=function(a){return b(a).chain()};b.mixin(b);l("pop push reverse shift sort splice unshift".split(" "),function(a){var d=m[a];b.prototype[a]=function(){var c=this._wrapped;d.apply(c,arguments);("shift"==a||"splice"==a)&&0===c.length&&delete c[0];return this._chain?b(c).chain():c}});l(["concat","join","slice"],function(a){var d=m[a];
b.prototype[a]=function(){var a=d.apply(this._wrapped,arguments);return this._chain?b(a).chain():a}});b.extend(b.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}});"function"===typeof define&&define.amd&&define("underscore",[],function(){return b})}).call(this);
(function(k,g){if("function"===typeof define&&define.amd)define(["underscore","jquery","exports"],function(e,y,n){k.Backbone=g(k,n,e,y)});else if("undefined"!==typeof exports){var e=require("underscore");g(k,exports,e,void 0)}else k.Backbone=g(k,{},k._,k.jQuery||k.Zepto||k.ender||k.$)})(this,function(k,g,e,v){var y=k.Backbone,n=[].slice;g.VERSION="1.1.1";g.$=v;g.noConflict=function(){k.Backbone=y;return this};g.emulateHTTP=!1;g.emulateJSON=!1;var l=g.Events={on:function(a,b,c){if(!r(this,"on",a,[b,
c])||!b)return this;this._events||(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this});return this},once:function(a,b,c){if(!r(this,"once",a,[b,c])||!b)return this;var d=this,f=e.once(function(){d.off(a,f);b.apply(this,arguments)});f._callback=b;return this.on(a,f,c)},off:function(a,b,c){var d,f,w,h,g,B,m,k;if(!this._events||!r(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events=void 0,this;h=a?[a]:e.keys(this._events);g=0;for(B=h.length;g<
B;g++)if(a=h[g],w=this._events[a]){this._events[a]=d=[];if(b||c){m=0;for(k=w.length;m<k;m++)f=w[m],(b&&b!==f.callback&&b!==f.callback._callback||c&&c!==f.context)&&d.push(f)}d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=n.call(arguments,1);if(!r(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;c&&C(c,b);d&&C(d,arguments);return this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var f=!b&&!c;!c&&
"object"===typeof b&&(c=this);a&&((d={})[a._listenId]=a);for(var w in d)a=d[w],a.off(b,c,this),(f||e.isEmpty(a._events))&&delete this._listeningTo[w];return this}},D=/\s+/,r=function(a,b,c,d){if(!c)return!0;if("object"===typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(d));return!1}if(D.test(c)){c=c.split(D);f=0;for(var e=c.length;f<e;f++)a[b].apply(a,[c[f]].concat(d));return!1}return!0},C=function(a,b){var c,d=-1,f=a.length,e=b[0],h=b[1],g=b[2];switch(b.length){case 0:for(;++d<f;)(c=a[d]).callback.call(c.ctx);
break;case 1:for(;++d<f;)(c=a[d]).callback.call(c.ctx,e);break;case 2:for(;++d<f;)(c=a[d]).callback.call(c.ctx,e,h);break;case 3:for(;++d<f;)(c=a[d]).callback.call(c.ctx,e,h,g);break;default:for(;++d<f;)(c=a[d]).callback.apply(c.ctx,b)}};e.each({listenTo:"on",listenToOnce:"once"},function(a,b){l[b]=function(b,d,f){var g=this._listeningTo||(this._listeningTo={}),h=b._listenId||(b._listenId=e.uniqueId("l"));g[h]=b;!f&&"object"===typeof d&&(f=this);b[a](d,f,this);return this}});l.bind=l.on;l.unbind=
l.off;e.extend(g,l);var x=g.Model=function(a,b){var c=a||{};b||(b={});this.cid=e.uniqueId("c");this.attributes={};b.collection&&(this.collection=b.collection);b.parse&&(c=this.parse(c,b)||{});c=e.defaults({},c,e.result(this,"defaults"));this.set(c,b);this.changed={};this.initialize.apply(this,arguments)};e.extend(x.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return e.clone(this.attributes)},sync:function(){return g.sync.apply(this,arguments)},
get:function(a){return this.attributes[a]},escape:function(a){return e.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,f,g,h,z,k,m;if(null==a)return this;"object"===typeof a?(f=a,c=b):(f={})[a]=b;c||(c={});if(!this._validate(f,c))return!1;g=c.unset;h=c.silent;a=[];z=this._changing;this._changing=!0;z||(this._previousAttributes=e.clone(this.attributes),this.changed={});m=this.attributes;k=this._previousAttributes;this.idAttribute in f&&(this.id=f[this.idAttribute]);
for(d in f)b=f[d],e.isEqual(m[d],b)||a.push(d),e.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete m[d]:m[d]=b;if(!h){a.length&&(this._pending=c);b=0;for(d=a.length;b<d;b++)this.trigger("change:"+a[b],this,m[a[b]],c)}if(z)return this;if(!h)for(;this._pending;)c=this._pending,this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(a,b){return this.set(a,void 0,e.extend({},b,{unset:!0}))},clear:function(a){var b={},c;for(c in this.attributes)b[c]=
void 0;return this.set(b,e.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!e.isEmpty(this.changed):e.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?e.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes,f;for(f in a)if(!e.isEqual(d[f],b=a[f]))(c||(c={}))[f]=b;return c},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return e.clone(this._previousAttributes)},
fetch:function(a){a=a?e.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d){if(!b.set(b.parse(d,a),a))return!1;c&&c(b,d,a);b.trigger("sync",b,d,a)};q(this,a);return this.sync("read",this,a)},save:function(a,b,c){var d,f=this.attributes;null==a||"object"===typeof a?(d=a,c=b):(d={})[a]=b;c=e.extend({validate:!0},c);if(d&&!c.wait){if(!this.set(d,c))return!1}else if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=e.extend({},f,d));void 0===c.parse&&(c.parse=
!0);var g=this,h=c.success;c.success=function(a){g.attributes=f;var b=g.parse(a,c);c.wait&&(b=e.extend(d||{},b));if(e.isObject(b)&&!g.set(b,c))return!1;h&&h(g,a,c);g.trigger("sync",g,a,c)};q(this,c);a=this.isNew()?"create":c.patch?"patch":"update";"patch"===a&&(c.attrs=d);a=this.sync(a,this,c);d&&c.wait&&(this.attributes=f);return a},destroy:function(a){a=a?e.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(e){(a.wait||b.isNew())&&d();c&&c(b,
e,a);b.isNew()||b.trigger("sync",b,e,a)};if(this.isNew())return a.success(),!1;q(this,a);var f=this.sync("delete",this,a);a.wait||d();return f},url:function(){var a=e.result(this,"urlRoot")||e.result(this.collection,"url")||E();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},e.extend(a||
{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=e.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;if(!c)return!0;this.trigger("invalid",this,c,e.extend(b,{validationError:c}));return!1}});e.each("keys values pairs invert pick omit".split(" "),function(a){x.prototype[a]=function(){var b=n.call(arguments);b.unshift(this.attributes);return e[a].apply(e,b)}});var u=g.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);
void 0!==b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,e.extend({silent:!0},b))},H={add:!0,remove:!0,merge:!0},I={add:!0,remove:!1};e.extend(u.prototype,l,{model:x,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return g.sync.apply(this,arguments)},add:function(a,b){return this.set(a,e.extend({merge:!1},b,I))},remove:function(a,b){var c=!e.isArray(a);a=c?[a]:e.clone(a);b||
(b={});var d,f,g,h;d=0;for(f=a.length;d<f;d++)if(h=a[d]=this.get(a[d]))delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h,b);return c?a[0]:a},set:function(a,b){b=e.defaults({},b,H);b.parse&&(a=this.parse(a,b));var c=!e.isArray(a);a=c?a?[a]:[]:e.clone(a);var d,f,g,h,k,l,m=b.at,p=this.model,n=this.comparator&&null==m&&!1!==b.sort,v=e.isString(this.comparator)?this.comparator:
null,s=[],r=[],q={},u=b.add,y=b.merge,A=b.remove,t=!n&&u&&A?[]:!1;d=0;for(f=a.length;d<f;d++){k=a[d]||{};g=k instanceof x?h=k:k[p.prototype.idAttribute||"id"];if(g=this.get(g))A&&(q[g.cid]=!0),y&&(k=k===h?h.attributes:k,b.parse&&(k=g.parse(k,b)),g.set(k,b),n&&(!l&&g.hasChanged(v))&&(l=!0)),a[d]=g;else if(u){h=a[d]=this._prepareModel(k,b);if(!h)continue;s.push(h);this._addReference(h,b)}h=g||h;t&&(h.isNew()||!q[h.id])&&t.push(h);q[h.id]=!0}if(A){d=0;for(f=this.length;d<f;++d)q[(h=this.models[d]).cid]||
r.push(h);r.length&&this.remove(r,b)}if(s.length||t&&t.length)if(n&&(l=!0),this.length+=s.length,null!=m){d=0;for(f=s.length;d<f;d++)this.models.splice(m+d,0,s[d])}else{t&&(this.models.length=0);k=t||s;d=0;for(f=k.length;d<f;d++)this.models.push(k[d])}l&&this.sort({silent:!0});if(!b.silent){d=0;for(f=s.length;d<f;d++)(h=s[d]).trigger("add",h,this,b);(l||t&&t.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c],
b);b.previousModels=this.models;this._reset();a=this.add(a,e.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return a},push:function(a,b){return this.add(a,e.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,e.extend({at:0},b))},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return n.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||
this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,b){return e.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var d in a)if(a[d]!==b.get(d))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");a||(a={});e.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(e.bind(this.comparator,
this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return e.invoke(this.models,"get",a)},fetch:function(a){a=a?e.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;a.success=function(d){c[a.reset?"reset":"set"](d,a);b&&b(c,d,a);c.trigger("sync",c,d,a)};q(this,a);return this.sync("read",this,a)},create:function(a,b){b=b?e.clone(b):{};if(!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;b.success=function(a,e){b.wait&&c.add(a,
b);d&&d(a,e,b)};a.save(null,b);return a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof x)return a;b=b?e.clone(b):{};b.collection=this;var c=new this.model(a,b);if(!c.validationError)return c;this.trigger("invalid",this,c.validationError,b);return!1},_addReference:function(a,b){this._byId[a.cid]=a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=
this);a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});e.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without difference indexOf shuffle lastIndexOf isEmpty chain sample".split(" "),
function(a){u.prototype[a]=function(){var b=n.call(arguments);b.unshift(this.models);return e[a].apply(e,b)}});e.each(["groupBy","countBy","sortBy","indexBy"],function(a){u.prototype[a]=function(b,c){var d=e.isFunction(b)?b:function(a){return a.get(b)};return e[a](this.models,d,c)}});v=g.View=function(a){this.cid=e.uniqueId("view");a||(a={});e.extend(this,e.pick(a,J));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var K=/^(\S+)\s*(.*)$/,J="model collection el id attributes className tagName events".split(" ");
e.extend(v.prototype,l,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof g.$?a:g.$(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(!a&&!(a=e.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];e.isFunction(c)||
(c=this[a[b]]);if(c){var d=b.match(K),f=d[1],d=d[2],c=e.bind(c,this),f=f+(".delegateEvents"+this.cid);if(""===d)this.$el.on(f,c);else this.$el.on(f,d,c)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_ensureElement:function(){if(this.el)this.setElement(e.result(this,"el"),!1);else{var a=e.extend({},e.result(this,"attributes"));this.id&&(a.id=e.result(this,"id"));this.className&&(a["class"]=e.result(this,"className"));a=g.$("<"+e.result(this,"tagName")+
">").attr(a);this.setElement(a,!1)}}});g.sync=function(a,b,c){var d=L[a];e.defaults(c||(c={}),{emulateHTTP:g.emulateHTTP,emulateJSON:g.emulateJSON});var f={type:d,dataType:"json"};c.url||(f.url=e.result(b,"url")||E());if(null==c.data&&b&&("create"===a||"update"===a||"patch"===a))f.contentType="application/json",f.data=JSON.stringify(c.attrs||b.toJSON(c));c.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{});if(c.emulateHTTP&&("PUT"===d||"DELETE"===d||"PATCH"===
d)){f.type="POST";c.emulateJSON&&(f.data._method=d);var k=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d);if(k)return k.apply(this,arguments)}}"GET"!==f.type&&!c.emulateJSON&&(f.processData=!1);"PATCH"===f.type&&M&&(f.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});a=c.xhr=g.ajax(e.extend(f,c));b.trigger("request",b,a,c);return a};var M="undefined"!==typeof window&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),
L={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};g.ajax=function(){return g.$.ajax.apply(g.$,arguments)};var F=g.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,O=/(\(\?)?:\w+/g,P=/\*\w+/g,Q=/[\-{}\[\]+?.,\\\^$|#\s]/g;e.extend(F.prototype,l,{initialize:function(){},route:function(a,b,c){e.isRegExp(a)||(a=this._routeToRegExp(a));e.isFunction(b)&&(c=b,b="");c||(c=this[b]);var d=this;g.history.route(a,
function(e){e=d._extractParameters(a,e);d.execute(c,e);d.trigger.apply(d,["route:"+b].concat(e));d.trigger("route",b,e);g.history.trigger("route",d,b,e)});return this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){g.history.navigate(a,b);return this},_bindRoutes:function(){if(this.routes){this.routes=e.result(this,"routes");for(var a,b=e.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){a=a.replace(Q,"\\$&").replace(N,"(?:$1)?").replace(O,
function(a,c){return c?a:"([^/?]+)"}).replace(P,"([^?]*?)");return RegExp("^"+a+"(?:\\?(.*))?$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return e.map(c,function(a,b){return b===c.length-1?a||null:a?decodeURIComponent(a):null})}});var p=g.History=function(){this.handlers=[];e.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},G=/^[#\/]|\s+$/g,R=/^\/+|\/+$/g,S=/msie [\w.]+/,T=/\/$/,U=/#.*$/;p.started=!1;e.extend(p.prototype,
l,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(T,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(G,"")},start:function(a){if(p.started)throw Error("Backbone.history has already been started");
p.started=!0;this.options=e.extend({root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);a=this.getFragment();var b=document.documentMode,b=S.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b);this.root=("/"+this.root+"/").replace(R,"/");b&&this._wantsHashChange&&(this.iframe=g.$('<iframe src="javascript:0" tabindex="-1">').hide().appendTo("body")[0].contentWindow,
this.navigate(a));if(this._hasPushState)g.$(window).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!b)g.$(window).on("hashchange",this.checkUrl);else this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&
(this.atRoot()&&a.hash)&&(this.fragment=this.getHash().replace(G,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){g.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);p.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));
if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()},loadUrl:function(a){a=this.fragment=this.getFragment(a);return e.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(a,b){if(!p.started)return!1;if(!b||!0===b)b={trigger:!!b};var c=this.root+(a=this.getFragment(a||""));a=a.replace(U,"");if(this.fragment!==a){this.fragment=a;""===a&&"/"!==c&&(c=c.slice(0,-1));if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},
document.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace));else return this.location.assign(c);if(b.trigger)return this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});g.history=new p;x.extend=u.extend=F.extend=v.extend=p.extend=function(a,
b){var c=this,d;d=a&&e.has(a,"constructor")?a.constructor:function(){return c.apply(this,arguments)};e.extend(d,c,b);var f=function(){this.constructor=d};f.prototype=c.prototype;d.prototype=new f;a&&e.extend(d.prototype,a);d.__super__=c.prototype;return d};var E=function(){throw Error('A "url" property or function must be specified');},q=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b);a.trigger("error",a,d,b)}};return g});
(function(){function u(a){return void 0!==a}function ma(){}function wb(a){a.tb=function(){return a.od?a.od:a.od=new a}}function za(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==
c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function na(a){return"array"==za(a)}function fc(a){var b=za(a);return"array"==b||"object"==b&&"number"==typeof a.length}function B(a){return"string"==typeof a}function Aa(a){return"number"==typeof a}function $a(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function Gd(a,
b,c){return a.call.apply(a.bind,arguments)}function Hd(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function v(a,b,c){v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Gd:Hd;return v.apply(null,arguments)}function X(a,b){function c(){}c.prototype=
b.prototype;a.ne=b.prototype;a.prototype=new c;a.le=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}}function Id(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);}function Jd(){this.qc=
void 0}function xb(a,b,c){switch(typeof b){case "string":gc(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(na(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],xb(a,a.qc?a.qc.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),
gc(f,c),c.push(":"),xb(a,a.qc?a.qc.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}function gc(a,b){b.push('"',a.replace(Kd,function(a){if(a in yb)return yb[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return yb[a]=e+b.toString(16)}),'"')}function zb(a){return"undefined"!==typeof JSON&&u(JSON.parse)?JSON.parse(a):Id(a)}function L(a){if("undefined"!==typeof JSON&&u(JSON.stringify))a=JSON.stringify(a);
else{var b=[];xb(new Jd,a,b);a=b.join("")}return a}function Ab(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e-=55296,d++,p(d<a.length,"Surrogate pair missing trail surrogate."),e=65536+(e<<10)+(a.charCodeAt(d)-56320));128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b}function q(a,b,c,d){var e;d<b?e="at least "+b:d>c&&(e=0===c?"none":"no more than "+c);if(e)throw Error(a+
" failed: Was called with "+d+(1===d?" argument.":" arguments.")+" Expects "+e+".");}function M(a,b,c){var d="";switch(b){case 1:d=c?"first":"First";break;case 2:d=c?"second":"Second";break;case 3:d=c?"third":"Third";break;case 4:d=c?"fourth":"Fourth";break;default:Ld.assert(!1,"errorPrefix_ called with argumentNumber > 4.  Need to update it?")}return a+" failed: "+(d+" argument ")}function y(a,b,c,d){if((!d||u(c))&&"function"!=za(c))throw Error(M(a,b,d)+"must be a valid function.");}function hc(a,
b,c){if(u(c)&&(!$a(c)||null===c))throw Error(M(a,b,!0)+"must be a valid context object.");}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function $(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]}function Bb(a){return B(a)&&0!==a.length&&!Md.test(a)}function oa(a,b,c){c&&!u(b)||ab(M(a,1,c),b)}function ab(a,b,c,d){c||(c=0);d=d||[];if(!u(b))throw Error(a+"contains undefined"+Ba(d));if("function"==za(b))throw Error(a+"contains a function"+Ba(d)+" with contents: "+b.toString());
if(ic(b))throw Error(a+"contains "+b.toString()+Ba(d));if(1E3<c)throw new TypeError(a+"contains a cyclic object value ("+d.slice(0,100).join(".")+"...)");if(B(b)&&b.length>10485760/3&&10485760<Ab(b).length)throw Error(a+"contains a string greater than 10485760 utf8 bytes"+Ba(d)+" ('"+b.substring(0,50)+"...')");if($a(b))for(var e in b)if(F(b,e)){var f=b[e];if(".priority"!==e&&".value"!==e&&".sv"!==e&&!Bb(e))throw Error(a+" contains an invalid key ("+e+")"+Ba(d)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');
d.push(e);ab(a,f,c+1,d);d.pop()}}function Ba(a){return 0==a.length?"":" in property '"+a.join(".")+"'"}function jc(a,b){if(!$a(b)||na(b))throw Error(M(a,1,!1)+" must be an Object containing the children to replace.");oa(a,b,!1)}function pa(a,b,c,d){if(!(d&&!u(c)||null===c||Aa(c)||B(c)||$a(c)&&F(c,".sv")))throw Error(M(a,b,d)+"must be a valid firebase priority (a string, number, or null).");}function Cb(a,b,c){if(!c||u(b))switch(b){case "value":case "child_added":case "child_removed":case "child_changed":case "child_moved":break;
default:throw Error(M(a,1,c)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".');}}function Db(a,b){if(u(b)&&!Bb(b))throw Error(M(a,2,!0)+'was an invalid key: "'+b+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").');}function bb(a,b){if(!B(b)||0===b.length||kc.test(b))throw Error(M(a,1,!1)+'was an invalid path: "'+b+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"');
}function N(a,b){if(".info"===G(b))throw Error(a+" failed: Can't modify data under /.info/");}function s(a,b,c,d,e,f,m){this.m=a;this.path=b;this.Ea=c;this.ea=d;this.ya=e;this.Ca=f;this.Za=m;if(u(this.ea)&&u(this.Ca)&&u(this.Ea))throw"Query: Can't combine startAt(), endAt(), and limit().";}function Eb(a){var b={};u(a.ea)&&(b.sp=a.ea);u(a.ya)&&(b.sn=a.ya);u(a.Ca)&&(b.ep=a.Ca);u(a.Za)&&(b.en=a.Za);u(a.Ea)&&(b.l=a.Ea);u(a.ea)&&u(a.ya)&&null===a.ea&&null===a.ya&&(b.vf="l");return b}function lc(a,b,c){var d=
{};if(b&&c)d.cancel=b,y(a,3,d.cancel,!0),d.Z=c,hc(a,4,d.Z);else if(b)if("object"===typeof b&&null!==b)d.Z=b;else if("function"===typeof b)d.cancel=b;else throw Error(Nd.me(a,3,!0)+"must either be a cancel callback or a context object.");return d}function n(a,b){if(1==arguments.length){this.o=a.split("/");for(var c=0,d=0;d<this.o.length;d++)0<this.o[d].length&&(this.o[c]=this.o[d],c++);this.o.length=c;this.V=0}else this.o=a,this.V=b}function G(a){return a.V>=a.o.length?null:a.o[a.V]}function T(a){var b=
a.V;b<a.o.length&&b++;return new n(a.o,b)}function mc(a,b){var c=G(a);if(null===c)return b;if(c===G(b))return mc(T(a),T(b));throw"INTERNAL ERROR: innerPath ("+b+") is not within outerPath ("+a+")";}function nc(){this.children={};this.Cc=0;this.value=null}function aa(a,b,c){this.Fa=a?a:"";this.Gb=b?b:null;this.C=c?c:new nc}function w(a,b){for(var c=b instanceof n?b:new n(b),d=a,e;null!==(e=G(c));)d=new aa(e,d,$(d.C.children,e)||new nc),c=T(c);return d}function Q(a,b){p("undefined"!==typeof b,"Cannot set value to undefined");
a.C.value=b;Fb(a)}function Ca(a,b,c,d){c&&!d&&b(a);a.A(function(a){Ca(a,b,!0,d)});c&&d&&b(a)}function cb(a,b,c){for(a=c?a:a.parent();null!==a;){if(b(a))return!0;a=a.parent()}return!1}function Fb(a){if(null!==a.Gb){var b=a.Gb,c=a.Fa,d=a.f(),e=F(b.C.children,c);d&&e?(delete b.C.children[c],b.C.Cc--,Fb(b)):d||e||(b.C.children[c]=a.C,b.C.Cc++,Fb(b))}}function ba(a,b){this.Wa=a?a:Od;this.da=b?b:Da}function Od(a,b){return a<b?-1:a>b?1:0}function oc(a,b){for(var c,d=a.da,e=null;!d.f();){c=a.Wa(b,d.key);
if(0===c){if(d.left.f())return e?e.key:null;for(d=d.left;!d.right.f();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?");}function Pd(a,b){this.xd=b;for(this.cc=[];!a.f();)this.cc.push(a),a=a.left}function Ea(a){if(0===a.cc.length)return null;var b=a.cc.pop(),c;c=a.xd?a.xd(b.key,b.value):{key:b.key,value:b.value};for(b=b.right;!b.f();)a.cc.push(b),b=b.left;return c}function qa(a,b,c,d,e){this.key=a;this.value=
b;this.color=null!=c?c:!0;this.left=null!=d?d:Da;this.right=null!=e?e:Da}function Gb(a){return a.left.f()?a:Gb(a.left)}function pc(a){if(a.left.f())return Da;a.left.Q()||a.left.left.Q()||(a=qc(a));a=a.K(null,null,null,pc(a.left),null);return Hb(a)}function Hb(a){a.right.Q()&&!a.left.Q()&&(a=rc(a));a.left.Q()&&a.left.left.Q()&&(a=db(a));a.left.Q()&&a.right.Q()&&(a=Fa(a));return a}function qc(a){a=Fa(a);a.right.left.Q()&&(a=a.K(null,null,null,null,db(a.right)),a=rc(a),a=Fa(a));return a}function rc(a){return a.right.K(null,
null,a.color,a.K(null,null,!0,null,a.right.left),null)}function db(a){return a.left.K(null,null,a.color,null,a.K(null,null,!0,a.left.right,null))}function Fa(a){return a.K(null,null,!a.color,a.left.K(null,null,!a.left.color,null,null),a.right.K(null,null,!a.right.color,null,null))}function sc(){}function Ga(a){this.Xb=a;this.lc="firebase:"}function Ha(){this.pb={}}function tc(a){try{if("undefined"!==typeof window&&"undefined"!==typeof window[a]){var b=window[a];b.setItem("firebase:sentinel","cache");
b.removeItem("firebase:sentinel");return new Ga(b)}}catch(c){}return new Ha}function Ib(a,b,c,d){this.host=a.toLowerCase();this.domain=this.host.substr(this.host.indexOf(".")+1);this.rc=b;this.bc=c;this.je=d;this.ha=ca.get("host:"+a)||this.host}function uc(a,b){b!==a.ha&&(a.ha=b,"s-"===a.ha.substr(0,2)&&ca.set("host:"+a.host,a.ha))}function eb(){this.qa=-1;this.qa=64;this.D=[];this.Bc=[];this.Id=[];this.ic=[];this.ic[0]=128;for(var a=1;a<this.qa;++a)this.ic[a]=0;this.vc=this.eb=0;this.reset()}function fb(a,
b,c){c||(c=0);var d=a.Id;if(B(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.D[0];c=a.D[1];for(var m=a.D[2],h=a.D[3],g=a.D[4],t,e=0;80>e;e++)40>e?20>e?(f=h^c&(m^h),t=1518500249):(f=c^m^h,t=1859775393):60>e?(f=c&m|h&(c|m),t=2400959708):(f=c^m^h,t=3395469782),f=(b<<5|b>>>27)+f+
g+t+d[e]&4294967295,g=h,h=m,m=(c<<30|c>>>2)&4294967295,c=b,b=f;a.D[0]=a.D[0]+b&4294967295;a.D[1]=a.D[1]+c&4294967295;a.D[2]=a.D[2]+m&4294967295;a.D[3]=a.D[3]+h&4294967295;a.D[4]=a.D[4]+g&4294967295}function Qd(a,b){var c;a:{c=a.length;for(var d=B(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){c=e;break a}c=-1}return 0>c?null:B(a)?a.charAt(c):a[c]}function ea(a){return-1!=ra.indexOf(a)}function vc(a,b){if(!fc(a))throw Error("encodeByteArray takes an array as a parameter");if(!gb){gb=
{};Jb={};for(var c=0;65>c;c++)gb[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c),Jb[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(c)}for(var c=b?Jb:gb,d=[],e=0;e<a.length;e+=3){var f=a[e],m=e+1<a.length,h=m?a[e+1]:0,g=e+2<a.length,t=g?a[e+2]:0,k=f>>2,f=(f&3)<<4|h>>4,h=(h&15)<<2|t>>6,t=t&63;g||(t=64,m||(h=64));d.push(c[k],c[f],c[h],c[t])}return d.join("")}function p(a,b){if(!a)throw Error("Firebase INTERNAL ASSERT FAILED:"+b);}function wc(a){var b=
Ab(a);a=new eb;a.update(b);var b=[],c=8*a.vc;56>a.eb?a.update(a.ic,56-a.eb):a.update(a.ic,a.qa-(a.eb-56));for(var d=a.qa-1;56<=d;d--)a.Bc[d]=c&255,c/=256;fb(a,a.Bc);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.D[d]>>e&255,++c;return vc(b)}function Ia(a){for(var b="",c=0;c<arguments.length;c++)b=fc(arguments[c])?b+Ia.apply(null,arguments[c]):"object"===typeof arguments[c]?b+L(arguments[c]):b+arguments[c],b+=" ";return b}function H(a){!0===xc&&(xc=!1,null===fa&&!0===Kb.get("logging_enabled")&&yc(!0));
if(fa){var b=Ia.apply(null,arguments);fa(b)}}function hb(a){return function(){H(a,arguments)}}function Lb(a){if("undefined"!==typeof console){var b="FIREBASE INTERNAL ERROR: "+Ia.apply(null,arguments);"undefined"!==typeof console.error?console.error(b):console.log(b)}}function zc(a){var b=Ia.apply(null,arguments);throw Error("FIREBASE FATAL ERROR: "+b);}function D(a){if("undefined"!==typeof console){var b="FIREBASE WARNING: "+Ia.apply(null,arguments);"undefined"!==typeof console.warn?console.warn(b):
console.log(b)}}function ic(a){return Aa(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function Rd(a){if("complete"===document.readyState)a();else{var b=!1,c=function(){document.body?b||(b=!0,a()):setTimeout(c,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&c()}),window.attachEvent("onload",
c))}}function ga(a,b){return a!==b?null===a?-1:null===b?1:typeof a!==typeof b?"number"===typeof a?-1:1:a>b?1:-1:0}function ha(a,b){if(a===b)return 0;var c=Ac(a),d=Ac(b);return null!==c?null!==d?0==c-d?a.length-b.length:c-d:-1:null!==d?1:a<b?-1:1}function Ja(a,b){if(b&&a in b)return b[a];throw Error("Missing required key ("+a+") in object: "+L(b));}function Mb(a){if("object"!==typeof a||null===a)return L(a);var b=[],c;for(c in a)b.push(c);b.sort();c="{";for(var d=0;d<b.length;d++)0!==d&&(c+=","),c+=
L(b[d]),c+=":",c+=Mb(a[b[d]]);return c+"}"}function Bc(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)d+b>a?c.push(a.substring(d,a.length)):c.push(a.substring(d,d+b));return c}function Nb(a,b){if(na(a))for(var c=0;c<a.length;++c)b(c,a[c]);else U(a,b)}function Cc(a){p(!ic(a),"Invalid JSON number");var b,c,d,e;0===a?(d=c=0,b=-Infinity===1/a?1:0):(b=0>a,a=Math.abs(a),a>=Math.pow(2,-1022)?(d=Math.min(Math.floor(Math.log(a)/Math.LN2),1023),c=d+1023,d=Math.round(a*Math.pow(2,52-d)-Math.pow(2,
52))):(c=0,d=Math.round(a/Math.pow(2,-1074))));e=[];for(a=52;a;a-=1)e.push(d%2?1:0),d=Math.floor(d/2);for(a=11;a;a-=1)e.push(c%2?1:0),c=Math.floor(c/2);e.push(b?1:0);e.reverse();b=e.join("");c="";for(a=0;64>a;a+=8)d=parseInt(b.substr(a,8),2).toString(16),1===d.length&&(d="0"+d),c+=d;return c.toLowerCase()}function Sd(a){var b="Unknown Error";"too_big"===a?b="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==a?b="Client doesn't have permission to access the desired data.":
"unavailable"==a&&(b="The service is unavailable");b=Error(a+": "+b);b.code=a.toUpperCase();return b}function Ac(a){return Td.test(a)&&(a=Number(a),-2147483648<=a&&2147483647>=a)?a:null}function sa(a){try{a()}catch(b){setTimeout(function(){throw b;},Math.floor(0))}}function ia(a,b){this.G=a;p(null!==this.G,"LeafNode shouldn't be created with null value.");this.ib="undefined"!==typeof b?b:null}function ib(a,b){return ga(a.ka,b.ka)||ha(a.name,b.name)}function Ud(a,b){return ha(a.name,b.name)}function Dc(a,
b){return ha(a,b)}function I(a,b){this.n=a||new ba(Dc);this.ib="undefined"!==typeof b?b:null}function Ka(a,b,c){I.call(this,a,c);null===b&&(b=new ba(ib),a.Da(function(a,c){b=b.sa({name:a,ka:c.k()},c)}));this.xa=b}function J(a,b){if(null===a)return z;var c=null;"object"===typeof a&&".priority"in a?c=a[".priority"]:"undefined"!==typeof b&&(c=b);p(null===c||"string"===typeof c||"number"===typeof c||"object"===typeof c&&".sv"in c,"Invalid priority type found: "+typeof c);"object"===typeof a&&".value"in
a&&null!==a[".value"]&&(a=a[".value"]);if("object"!==typeof a||".sv"in a)return new ia(a,c);if(a instanceof Array){var d=z,e=a;U(e,function(a,b){if(F(e,b)&&"."!==b.substring(0,1)){var c=J(a);if(c.P()||!c.f())d=d.I(b,c)}});return d.Ia(c)}var f=[],m={},h=!1,g=a;Nb(g,function(a,b){if("string"!==typeof b||"."!==b.substring(0,1)){var c=J(g[b]);c.f()||(h=h||null!==c.k(),f.push({name:b,ka:c.k()}),m[b]=c)}});var t=Ec(f,m,!1);if(h){var k=Ec(f,m,!0);return new Ka(t,k,c)}return new I(t,c)}function Vd(a){this.count=
parseInt(Math.log(a+1)/Wd,10);this.gd=this.count-1;this.Kd=a+1&parseInt(Array(this.count+1).join("1"),2)}function Xd(a){var b=!(a.Kd&1<<a.gd);a.gd--;return b}function Ec(a,b,c){function d(e,f){var g=f-e;if(0==g)return null;if(1==g){var g=a[e].name,t=c?a[e]:g;return new qa(t,b[g],!1,null,null)}var t=parseInt(g/2,10)+e,k=d(e,t),l=d(t+1,f),g=a[t].name,t=c?a[t]:g;return new qa(t,b[g],!1,k,l)}var e=c?ib:Ud;a.sort(e);var f=function(e){function f(e,m){var h=k-e,l=k;k-=e;var q=a[h].name,h=new qa(c?a[h]:q,
b[q],m,null,d(h+1,l));g?g.left=h:t=h;g=h}for(var g=null,t=null,k=a.length,l=0;l<e.count;++l){var q=Xd(e),r=Math.pow(2,e.count-(l+1));q?f(r,!1):(f(r,!1),f(r,!0))}return t}(new Vd(a.length)),e=c?ib:Dc;return null!==f?new ba(e,f):new ba(e)}function Fc(a){return"number"===typeof a?"number:"+Cc(a):"string:"+a}function r(a,b){this.C=a;this.oc=b}function ja(a){p(na(a)&&0<a.length,"Requires a non-empty array");this.Jd=a;this.yb={}}function Gc(a,b){p(Qd(a.Jd,function(a){return a===b}),"Unknown event: "+b)}
function jb(){ja.call(this,["visible"]);var a,b;"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(b="visibilitychange",a="hidden"):"undefined"!==typeof document.mozHidden?(b="mozvisibilitychange",a="mozHidden"):"undefined"!==typeof document.msHidden?(b="msvisibilitychange",a="msHidden"):"undefined"!==typeof document.webkitHidden&&(b="webkitvisibilitychange",a="webkitHidden"));this.nb=!0;if(b){var c=this;document.addEventListener(b,
function(){var b=!document[a];b!==c.nb&&(c.nb=b,c.dd("visible",b))},!1)}}function kb(){ja.call(this,["online"]);this.Eb=!0;if("undefined"!==typeof window&&"undefined"!==typeof window.addEventListener){var a=this;window.addEventListener("online",function(){a.Eb||a.dd("online",!0);a.Eb=!0},!1);window.addEventListener("offline",function(){a.Eb&&a.dd("online",!1);a.Eb=!1},!1)}}function U(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Yd(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Hc(a){var b=
{},c;for(c in a)b[c]=a[c];return b}function Ic(){this.qb={}}function ua(a,b,c){u(c)||(c=1);F(a.qb,b)||(a.qb[b]=0);a.qb[b]+=c}function Ob(a){this.Ld=a;this.Zb=null}function Jc(a,b){this.ad={};this.uc=new Ob(a);this.u=b;var c=1E4+2E4*Math.random();setTimeout(v(this.vd,this),Math.floor(c))}function Pb(a){a=a.toString();Qb[a]||(Qb[a]=new Ic);return Qb[a]}function Zd(a,b){var c=a.toString();Rb[c]||(Rb[c]=b());return Rb[c]}function R(a,b,c){this.Ec=a;this.e=hb(this.Ec);this.frames=this.wb=null;this.Ja=
this.Ka=this.cd=0;this.fa=Pb(b);this.Xa=(b.rc?"wss://":"ws://")+b.ha+"/.ws?v=5";b.host!==b.ha&&(this.Xa=this.Xa+"&ns="+b.bc);c&&(this.Xa=this.Xa+"&s="+c)}function Kc(a,b){a.frames.push(b);if(a.frames.length==a.cd){var c=a.frames.join("");a.frames=null;c=zb(c);a.Xd(c)}}function Sb(a){clearInterval(a.wb);a.wb=setInterval(function(){a.X&&a.X.send("0");Sb(a)},Math.floor(45E3))}function $d(a){this.Rc=a;this.kc=[];this.Ya=0;this.Dc=-1;this.Qa=null}function ae(a,b,c){a.Dc=b;a.Qa=c;a.Dc<a.Ya&&(a.Qa(),a.Qa=
null)}function be(a,b,c){for(a.kc[b]=c;a.kc[a.Ya];){var d=a.kc[a.Ya];delete a.kc[a.Ya];for(var e=0;e<d.length;++e)if(d[e]){var f=a;sa(function(){f.Rc(d[e])})}if(a.Ya===a.Dc){a.Qa&&(clearTimeout(a.Qa),a.Qa(),a.Qa=null);break}a.Ya++}}function lb(){this.set={}}function S(a,b){U(a.set,function(a,d){b(d,a)})}function La(a,b,c){this.Ec=a;this.e=hb(a);this.Ja=this.Ka=0;this.fa=Pb(b);this.tc=c;this.rb=!1;this.Sb=function(a){b.host!==b.ha&&(a.ns=b.bc);var c=[],f;for(f in a)a.hasOwnProperty(f)&&c.push(f+"="+
a[f]);return(b.rc?"https://":"http://")+b.ha+"/.lp?"+c.join("&")}}function Lc(a,b){var c=L(b).length;a.Ja+=c;ua(a.fa,"bytes_received",c)}function Mc(a,b,c,d){this.Sb=d;this.ja=c;this.Tc=new lb;this.Ib=[];this.Fc=Math.floor(1E8*Math.random());this.sc=!0;this.wc=mb();window["pLPCommand"+this.wc]=a;window["pRTLPCB"+this.wc]=b;a=document.createElement("iframe");a.style.display="none";if(document.body){document.body.appendChild(a);try{a.contentWindow.document||H("No IE domain setting required")}catch(e){a.src=
"javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";a.contentDocument?a.Ba=a.contentDocument:a.contentWindow?a.Ba=a.contentWindow.document:a.document&&(a.Ba=a.document);this.$=a;a="";this.$.src&&"javascript:"===this.$.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";\x3c/script>');a="<html><body>"+a+"</body></html>";
try{this.$.Ba.open(),this.$.Ba.write(a),this.$.Ba.close()}catch(f){H("frame writing exception"),f.stack&&H(f.stack),H(f)}}function Tb(a){if(a.zc&&a.sc&&a.Tc.count()<(0<a.Ib.length?2:1)){a.Fc++;var b={};b.id=a.Vd;b.pw=a.Wd;b.ser=a.Fc;for(var b=a.Sb(b),c="",d=0;0<a.Ib.length;)if(1870>=a.Ib[0].hd.length+30+c.length){var e=a.Ib.shift(),c=c+"&seg"+d+"="+e.ee+"&ts"+d+"="+e.ie+"&d"+d+"="+e.hd;d++}else break;ce(a,b+c,a.Fc);return!0}return!1}function ce(a,b,c){function d(){a.Tc.remove(c);Tb(a)}a.Tc.add(c);
var e=setTimeout(d,Math.floor(25E3));Nc(a,b,function(){clearTimeout(e);d()})}function Nc(a,b,c){setTimeout(function(){try{if(a.sc){var d=a.$.Ba.createElement("script");d.type="text/javascript";d.async=!0;d.src=b;d.onload=d.onreadystatechange=function(){var a=d.readyState;a&&"loaded"!==a&&"complete"!==a||(d.onload=d.onreadystatechange=null,d.parentNode&&d.parentNode.removeChild(d),c())};d.onerror=function(){H("Long-poll script failed to load: "+b);a.sc=!1;a.close()};a.$.Ba.body.appendChild(d)}}catch(e){}},
Math.floor(1))}function de(a){ee(this,a)}function ee(a,b){var c=R&&R.isAvailable(),d=c&&!(ca.qd||!0===ca.get("previous_websocket_failure"));b.je&&(c||D("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),d=!0);if(d)a.Pb=[R];else{var e=a.Pb=[];Nb(fe,function(a,b){b&&b.isAvailable()&&e.push(b)})}}function ge(a){if(0<a.Pb.length)return a.Pb[0];throw Error("No transports available");}function V(a,b,c,d,e,f){this.id=a;this.e=hb("c:"+this.id+":");this.Rc=c;this.Db=d;this.T=
e;this.Qc=f;this.N=b;this.jc=[];this.ed=0;this.Ed=new de(b);this.na=0;this.e("Connection created");Oc(this)}function Oc(a){var b=ge(a.Ed);a.B=new b("c:"+a.id+":"+a.ed++,a.N);a.Vc=b.responsesRequiredToBeHealthy||0;var c=Pc(a,a.B),d=Qc(a,a.B);a.Qb=a.B;a.Nb=a.B;a.w=null;a.Pa=!1;setTimeout(function(){a.B&&a.B.open(c,d)},Math.floor(0));b=b.healthyTimeout||0;0<b&&(a.Yb=setTimeout(function(){a.Yb=null;a.Pa||(a.B&&102400<a.B.Ja?(a.e("Connection exceeded healthy timeout but has received "+a.B.Ja+" bytes.  Marking connection healthy."),
a.Pa=!0,a.B.$b()):a.B&&10240<a.B.Ka?a.e("Connection exceeded healthy timeout but has sent "+a.B.Ka+" bytes.  Leaving connection alive."):(a.e("Closing unhealthy connection after timeout."),a.close()))},Math.floor(b)))}function Qc(a,b){return function(c){b===a.B?(a.B=null,c||0!==a.na?1===a.na&&a.e("Realtime connection lost."):(a.e("Realtime connection failed."),"s-"===a.N.ha.substr(0,2)&&(ca.remove("host:"+a.N.host),a.N.ha=a.N.host)),a.close()):b===a.w?(a.e("Secondary connection lost."),c=a.w,a.w=
null,a.Qb!==c&&a.Nb!==c||a.close()):a.e("closing an old connection")}}function Pc(a,b){return function(c){if(2!=a.na)if(b===a.Nb){var d=Ja("t",c);c=Ja("d",c);if("c"==d){if(d=Ja("t",c),"d"in c)if(c=c.d,"h"===d){var d=c.ts,e=c.v,f=c.h;a.tc=c.s;uc(a.N,f);0==a.na&&(a.B.start(),he(a,a.B,d),"5"!==e&&D("Protocol version mismatch detected"),c=a.Ed,(c=1<c.Pb.length?c.Pb[1]:null)&&ie(a,c))}else if("n"===d){a.e("recvd end transmission on primary");a.Nb=a.w;for(c=0;c<a.jc.length;++c)a.gc(a.jc[c]);a.jc=[];Rc(a)}else"s"===
d?(a.e("Connection shutdown command received. Shutting down..."),a.Qc&&(a.Qc(c),a.Qc=null),a.T=null,a.close()):"r"===d?(a.e("Reset packet received.  New host: "+c),uc(a.N,c),1===a.na?a.close():(Sc(a),Oc(a))):"e"===d?Lb("Server Error: "+c):"o"===d?(a.e("got pong on primary."),Tc(a),Uc(a)):Lb("Unknown control packet command: "+d)}else"d"==d&&a.gc(c)}else if(b===a.w)if(d=Ja("t",c),c=Ja("d",c),"c"==d)"t"in c&&(c=c.t,"a"===c?Vc(a):"r"===c?(a.e("Got a reset on secondary, closing it"),a.w.close(),a.Qb!==
a.w&&a.Nb!==a.w||a.close()):"o"===c&&(a.e("got pong on secondary."),a.zd--,Vc(a)));else if("d"==d)a.jc.push(c);else throw Error("Unknown protocol layer: "+d);else a.e("message on old connection")}}function Rc(a){a.Qb===a.w&&a.Nb===a.w&&(a.e("cleaning up and promoting a connection: "+a.w.Ec),a.B=a.w,a.w=null)}function Vc(a){0>=a.zd?(a.e("Secondary connection is healthy."),a.Pa=!0,a.w.$b(),a.w.start(),a.e("sending client ack on secondary"),a.w.send({t:"c",d:{t:"a",d:{}}}),a.e("Ending transmission on primary"),
a.B.send({t:"c",d:{t:"n",d:{}}}),a.Qb=a.w,Rc(a)):(a.e("sending ping on secondary."),a.w.send({t:"c",d:{t:"p",d:{}}}))}function Tc(a){a.Pa||(a.Vc--,0>=a.Vc&&(a.e("Primary connection is healthy."),a.Pa=!0,a.B.$b()))}function ie(a,b){a.w=new b("c:"+a.id+":"+a.ed++,a.N,a.tc);a.zd=b.responsesRequiredToBeHealthy||0;a.w.open(Pc(a,a.w),Qc(a,a.w));setTimeout(function(){a.w&&(a.e("Timed out trying to upgrade."),a.w.close())},Math.floor(6E4))}function he(a,b,c){a.e("Realtime connection established.");a.B=b;
a.na=1;a.Db&&(a.Db(c),a.Db=null);0===a.Vc?(a.e("Primary connection is healthy."),a.Pa=!0):setTimeout(function(){Uc(a)},Math.floor(5E3))}function Uc(a){a.Pa||1!==a.na||(a.e("sending ping on primary."),Wc(a,{t:"c",d:{t:"p",d:{}}}))}function Wc(a,b){if(1!==a.na)throw"Connection is not connected";a.Qb.send(b)}function Sc(a){a.e("Shutting down all connections");a.B&&(a.B.close(),a.B=null);a.w&&(a.w.close(),a.w=null);a.Yb&&(clearTimeout(a.Yb),a.Yb=null)}function ka(a,b,c,d,e,f){this.id=je++;this.e=hb("p:"+
this.id+":");this.Ua=!0;this.ia={};this.U=[];this.Fb=0;this.Cb=[];this.S=!1;this.ua=1E3;this.ac=3E5;this.hc=b||ma;this.fc=c||ma;this.Bb=d||ma;this.Sc=e||ma;this.Jc=f||ma;this.N=a;this.Xc=null;this.Mb={};this.de=0;this.xb=this.Nc=null;Ma(this,0);jb.tb().hb("visible",this.Zd,this);-1===a.host.indexOf("fblocal")&&kb.tb().hb("online",this.Yd,this)}function ke(a,b,c){var d=b.toString(),e=b.path().toString();a.ia[e]=a.ia[e]||{};p(!a.ia[e][d],"listen() called twice for same path/queryId.");a.ia[e][d]={jb:b.jb(),
F:c};a.S&&Xc(a,e,d,b.jb(),c)}function Xc(a,b,c,d,e){a.e("Listen on "+b+" for "+c);var f={p:b};d=nb(d,function(a){return Eb(a)});"{}"!==c&&(f.q=d);f.h=a.Jc(b);a.Ga("l",f,function(d){a.e("listen response",d);d=d.s;"ok"!==d&&Ub(a,b,c);e&&e(d)})}function Yc(a){var b=a.Ma;a.S&&b&&a.Ga("auth",{cred:b.Md},function(c){var d=c.s;c=c.d||"error";"ok"!==d&&a.Ma===b&&delete a.Ma;a.Bb("ok"===d);b.kd?"ok"!==d&&b.Ub&&b.Ub(d,c):(b.kd=!0,b.ba&&b.ba(d,c))})}function Zc(a,b,c,d){b=b.toString();Ub(a,b,c)&&a.S&&le(a,b,
c,d)}function le(a,b,c,d){a.e("Unlisten on "+b+" for "+c);b={p:b};d=nb(d,function(a){return Eb(a)});"{}"!==c&&(b.q=d);a.Ga("u",b)}function $c(a,b,c,d){a.S?ob(a,"o",b,c,d):a.Cb.push({Uc:b,action:"o",data:c,F:d})}function me(a,b,c,d){a.S?ob(a,"om",b,c,d):a.Cb.push({Uc:b,action:"om",data:c,F:d})}function ob(a,b,c,d,e){c={p:c,d:d};a.e("onDisconnect "+b,c);a.Ga(b,c,function(a){e&&setTimeout(function(){e(a.s,a.d)},Math.floor(0))})}function ne(a,b,c,d){ad(a,"m",b,c,d,void 0)}function ad(a,b,c,d,e,f){c={p:c,
d:d};u(f)&&(c.h=f);a.U.push({action:b,wd:c,F:e});a.Fb++;b=a.U.length-1;a.S&&bd(a,b)}function bd(a,b){var c=a.U[b].action,d=a.U[b].wd,e=a.U[b].F;a.U[b].ae=a.S;a.Ga(c,d,function(d){a.e(c+" response",d);delete a.U[b];a.Fb--;0===a.Fb&&(a.U=[]);e&&e(d.s,d.d)})}function Ma(a,b){p(!a.la,"Scheduling a connect when we're already connected/ing?");a.$a&&clearTimeout(a.$a);a.$a=setTimeout(function(){a.$a=null;oe(a)},Math.floor(b))}function oe(a){if(a.Ua){a.e("Making a connection attempt");a.Nc=(new Date).getTime();
a.xb=null;var b=v(a.gc,a),c=v(a.Db,a),d=v(a.sd,a),e=a.id+":"+pe++;a.la=new V(e,a.N,b,c,d,function(b){D(b+" ("+a.N.toString()+")");a.Ua=!1})}}function qe(a,b,c){c=c?nb(c,function(a){return Mb(a)}).join("$"):"{}";(a=Ub(a,b,c))&&a.F&&a.F("permission_denied")}function Ub(a,b,c){b=(new n(b)).toString();c||(c="{}");var d=a.ia[b][c];delete a.ia[b][c];return d}function Na(){this.n=this.G=null}function va(a,b,c){if(b.f())a.G=c,a.n=null;else if(null!==a.G)a.G=a.G.Aa(b,c);else{null==a.n&&(a.n=new lb);var d=
G(b);a.n.contains(d)||a.n.add(d,new Na);a=a.n.get(d);b=T(b);va(a,b,c)}}function Vb(a,b){if(b.f())return a.G=null,a.n=null,!0;if(null!==a.G){if(a.G.P())return!1;var c=a.G;a.G=null;c.A(function(b,c){va(a,new n(b),c)});return Vb(a,b)}return null!==a.n?(c=G(b),b=T(b),a.n.contains(c)&&Vb(a.n.get(c),b)&&a.n.remove(c),a.n.f()?(a.n=null,!0):!1):!0}function Wb(a,b,c){null!==a.G?c(b,a.G):a.A(function(a,e){var f=new n(b.toString()+"/"+a);Wb(e,f,c)})}function wa(){this.aa=z}function x(a,b){return a.aa.L(b)}function E(a,
b,c){a.aa=a.aa.Aa(b,c)}function cd(){this.va=new wa;this.M=new wa;this.pa=new wa;this.Hb=new aa}function re(a,b,c){E(a.va,b,c);return Oa(a,b)}function Oa(a,b){for(var c=x(a.va,b),d=x(a.M,b),e=w(a.Hb,b),f=!1,m=e;null!==m;){if(null!==m.j()){f=!0;break}m=m.parent()}if(f)return!1;c=dd(c,d,e);return c!==d?(E(a.M,b,c),!0):!1}function dd(a,b,c){if(c.f())return a;if(null!==c.j())return b;a=a||z;c.A(function(d){d=d.name();var e=a.O(d),f=b.O(d),m=w(c,d),e=dd(e,f,m);a=a.I(d,e)});return a}function pb(a,b){Pa(b,
function(b){var d=b.fe;b=w(a.Hb,b.path);var e=b.j();p(null!==e,"pendingPut should not be null.");e===d&&Q(b,null)})}function Xb(a,b){return a&&"object"===typeof a?(p(".sv"in a,"Unexpected leaf node or priority contents"),b[a[".sv"]]):a}function se(a,b){var c=new Na;Wb(a,new n(""),function(a,e){va(c,a,Qa(e,b))});return c}function Qa(a,b){var c=Xb(a.k(),b),d;if(a.P()){var e=Xb(a.j(),b);return e!==a.j()||c!==a.k()?new ia(e,c):a}d=a;c!==a.k()&&(d=d.Ia(c));a.A(function(a,c){var e=Qa(c,b);e!==c&&(d=d.I(a,
e))});return d}function ed(){this.ab=[]}function fd(a,b){if(0!==b.length)for(var c=0;c<b.length;c++)a.ab.push(b[c])}function te(a){var b=a.ba,c=a.Bd,d=a.Jb;sa(function(){b(c,d)})}function C(a,b,c,d){this.type=a;this.wa=b;this.ca=c;this.Jb=d}function xa(a){this.R=a;this.ra=[];this.Gc=new ed}function gd(a,b,c,d,e){a.ra.push({type:b,ba:c,cancel:d,Z:e});d=[];var f=hd(a.i);a.vb&&f.push(new C("value",a.i));for(var m=0;m<f.length;m++)if(f[m].type===b){var h=new k(a.R.m,a.R.path);f[m].ca&&(h=h.H(f[m].ca));
d.push({ba:e?v(c,e):c,Bd:new r(f[m].wa,h),Jb:f[m].Jb})}fd(a.Gc,d)}function id(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=e.type,m=new k(a.R.m,a.R.path);b[d].ca&&(m=m.H(b[d].ca));m=new r(b[d].wa,m);"value"!==e.type||m.ub()?"value"!==e.type&&(f+=" "+m.name()):f+="("+m.W()+")";H(a.R.m.u.id+": event:"+a.R.path+":"+a.R.Sa()+":"+f);for(f=0;f<a.ra.length;f++){var h=a.ra[f];b[d].type===h.type&&c.push({ba:h.Z?v(h.ba,h.Z):h.ba,Bd:m,Jb:e.Jb})}}fd(a.Gc,c)}function hd(a){var b=[];if(!a.P()){var c=null;
a.A(function(a,e){b.push(new C("child_added",e,a,c));c=a})}return b}function Yb(a){a.vb||(a.vb=!0,id(a,[new C("value",a.i)]))}function qb(a,b){xa.call(this,a);this.i=b}function ue(a,b){this.Wb=a;this.Oc=b}function jd(a,b,c,d,e){var f=a.L(c),m=b.L(c);d=new ue(d,e);e=Ra(d,c,f,m);m=!f.f()&&!m.f()&&f.k()!==m.k();if(e||m){f=c;for(c=e;null!==f.parent();){var h=a.L(f);e=b.L(f);var g=f.parent();if(!d.Wb||w(d.Wb,g).j()){var t=b.L(g),k=[],f=f.V<f.o.length?f.o[f.o.length-1]:null;h.f()?(h=t.ga(f,e),k.push(new C("child_added",
e,f,h))):e.f()?k.push(new C("child_removed",h,f)):(h=t.ga(f,e),m&&k.push(new C("child_moved",e,f,h)),c&&k.push(new C("child_changed",e,f,h)));d.Oc(g,t,k)}m&&(m=!1,c=!0);f=g}}}function Ra(a,b,c,d){var e,f=[];c===d?e=!1:c.P()&&d.P()?e=c.j()!==d.j():c.P()?(Zb(a,b,z,d,f),e=!0):d.P()?(Zb(a,b,c,z,f),e=!0):e=Zb(a,b,c,d,f);e?a.Oc(b,d,f):c.k()!==d.k()&&a.Oc(b,d,null);return e}function Zb(a,b,c,d,e){var f=!1,m=!a.Wb||!w(a.Wb,b).f(),h=[],g=[],t=[],k=[],l={},q={},r,s,p,n;r=c.bb();p=Ea(r);s=d.bb();for(n=Ea(s);null!==
p||null!==n;)if(c=n,c=null===p?1:null===c?-1:p.key===c.key?0:ib({name:p.key,ka:p.value.k()},{name:c.key,ka:c.value.k()}),0>c?(f=$(l,p.key),u(f)?(t.push({Ic:p,bd:h[f]}),h[f]=null):(q[p.key]=g.length,g.push(p)),f=!0,p=Ea(r)):(0<c?(f=$(q,n.key),u(f)?(t.push({Ic:g[f],bd:n}),g[f]=null):(l[n.key]=h.length,h.push(n)),f=!0):(c=b.H(n.key),Ra(a,c,p.value,n.value)&&(k.push(n),f=!0),p.value.k()!==n.value.k()&&(t.push({Ic:p,bd:n}),f=!0),p=Ea(r)),n=Ea(s)),!m&&f)return!0;for(m=0;m<g.length;m++)if(l=g[m])c=b.H(l.key),
Ra(a,c,l.value,z),e.push(new C("child_removed",l.value,l.key));for(m=0;m<h.length;m++)if(l=h[m])c=b.H(l.key),g=d.ga(l.key,l.value),Ra(a,c,z,l.value),e.push(new C("child_added",l.value,l.key,g));for(m=0;m<t.length;m++)l=t[m].Ic,h=t[m].bd,c=b.H(h.key),g=d.ga(h.key,h.value),e.push(new C("child_moved",h.value,h.key,g)),Ra(a,c,l.value,h.value)&&k.push(h);for(m=0;m<k.length;m++)a=k[m],g=d.ga(a.key,a.value),e.push(new C("child_changed",a.value,a.key,g));return f}function $b(){this.Y=this.za=null;this.set=
{}}function kd(a,b,c){a.add(b,c);a.Y||(a.Y=c.R.path)}function ve(a){var b=a.za;a.za=null;return b}function la(a){return a.contains("default")}function Sa(a){return null!=a.za&&la(a)}function Ta(a,b){xa.call(this,a);this.i=z;this.nc(b,hd(b))}function ld(a,b,c,d){if(a.P())return null;var e=null;(d?a.Hc:a.A).call(a,function(a,d){if(rb(b,a,d)&&(e=a,c--,0===c))return!0});return e}function rb(a,b,c){for(var d=0;d<a.length;d++)if(!a[d](b,c.k()))return!1;return!0}function ya(a,b){this.u=a;this.g=b;this.ec=
b.aa;this.oa=new aa}function md(a,b,c,d,e){var f=a.get(b),m;if(m=f){m=!1;for(var g=f.ra.length-1;0<=g;g--){var da=f.ra[g];if(!(c&&da.type!==c||d&&da.ba!==d||e&&da.Z!==e)&&(f.ra.splice(g,1),m=!0,c&&d))break}}(c=m&&!(0<f.ra.length))&&a.remove(b);return c}function we(a,b,c,d,e){b=b?b.Sa():null;var f=[];b&&"default"!==b?md(a,b,c,d,e)&&f.push(b):Pa(a.keys(),function(b){md(a,b,c,d,e)&&f.push(b)});return f}function nd(a,b,c,d,e,f){var m=b.path(),m=w(a.oa,m);c=we(b,c,d,e,f);b.f()&&Q(m,null);d=od(m);if(0<
c.length&&!d){d=m;e=m.parent();for(c=!1;!c&&e;){if(f=e.j()){p(!Sa(f));var g=d.name(),da=!1;S(f,function(a,b){da=b.Kc(g)||da});da&&(c=!0)}d=e;e=e.parent()}d=null;Sa(b)||(b=ve(b),d=xe(a,m),b&&b());return c?null:d}return null}function sb(a,b,c){Ca(w(a.oa,b),function(a){(a=a.j())&&S(a,function(a,b){Yb(b)})},c,!0)}function O(a,b,c){function d(a){do{if(m[a.toString()])return!0;a=a.parent()}while(null!==a);return!1}var e=a.ec,f=a.g.aa;a.ec=f;for(var m={},g=0;g<c.length;g++)m[c[g].toString()]=!0;jd(e,f,b,
a.oa,function(c,e,f){if(b.contains(c)){var g=d(c);g&&sb(a,c,!1);a.mc(c,e,f);g&&sb(a,c,!0)}else a.mc(c,e,f)});d(b)&&sb(a,b,!0);pd(a,b)}function pd(a,b){var c=w(a.oa,b);Ca(c,function(a){(a=a.j())&&S(a,function(a,b){b.Kb()})},!0,!0);cb(c,function(a){(a=a.j())&&S(a,function(a,b){b.Kb()})},!1)}function od(a){return cb(a,function(a){return a.j()&&Sa(a.j())})}function ye(a,b,c,d,e){if(Sa(c)||od(b))kd(c,d,e);else{var f,g;c.f()||(f=c.toString(),g=c.jb());kd(c,d,e);c.setActive(ac(a,c));f&&g&&Zc(a.u,c.path(),
f,g)}Sa(c)&&Ca(b,function(a){if(a=a.j())a.za&&a.za(),a.za=null})}function xe(a,b){function c(b){var f=b.j();if(f&&la(f))d.push(f.path()),null==f.za&&f.setActive(ac(a,f));else{if(f){null!=f.za||f.setActive(ac(a,f));var g={};S(f,function(a,b){b.i.A(function(a){F(g,a)||(g[a]=!0,a=f.path().H(a),d.push(a))})})}b.A(c)}}var d=[];c(b);return d}function ac(a,b){if(a.u){var c=a.u,d=b.path(),e=b.toString(),f=b.jb(),g,h=b.keys(),k=la(b);ke(a.u,b,function(c){"ok"!==c?(c=Sd(c),D("on() or once() for "+b.path().toString()+
" failed: "+c.toString()),ze(a,b,c)):g||(k?sb(a,b.path(),!0):Pa(h,function(a){(a=b.get(a))&&Yb(a)}),pd(a,b.path()))});return function(){g=!0;Zc(c,d,e,f)}}return ma}function ze(a,b,c){b&&(S(b,function(a,b){for(var f=0;f<b.ra.length;f++){var g=b.ra[f];g.cancel&&(g.Z?v(g.cancel,g.Z):g.cancel)(c)}}),nd(a,b))}function qd(a,b,c,d,e){var f=b.path();b=a.sb(f,b,d,e);var g=z,h=[];U(b,function(b,k){var l=new n(k);3===b||1===b?g=g.I(k,d.L(l)):(2===b&&h.push({path:f.H(k),ta:z}),h=h.concat(bc(a,d.L(l),w(c,l),e)))});
return[{path:f,ta:g}].concat(h)}function Ua(a,b,c,d){var e;a:{var f=w(a.oa,b);e=f.parent();for(var g=[];null!==e;){var h=e.j();if(null!==h){if(la(h)){e=[{path:b,ta:c}];break a}h=a.sb(b,h,c,d);f=$(h,f.name());if(3===f||1===f){e=[{path:b,ta:c}];break a}2===f&&g.push({path:b,ta:z})}f=e;e=e.parent()}e=g}if(1==e.length&&(!e[0].ta.f()||c.f()))return e;g=w(a.oa,b);f=g.j();null!==f?la(f)?e.push({path:b,ta:c}):e=e.concat(qd(a,f,g,c,d)):e=e.concat(bc(a,c,g,d));return e}function bc(a,b,c,d){var e=c.j();if(null!==
e)return la(e)?[{path:c.path(),ta:b}]:qd(a,e,c,b,d);var f=[];c.A(function(c){var e=b.P()?z:b.O(c.name());c=bc(a,e,c,d);f=f.concat(c)});return f}function cc(a){this.N=a;this.fa=Pb(a);this.u=new ka(this.N,v(this.hc,this),v(this.fc,this),v(this.Bb,this),v(this.Sc,this),v(this.Jc,this));this.Dd=Zd(a,v(function(){return new Jc(this.fa,this.u)},this));this.Va=new aa;this.Ha=new wa;this.g=new cd;this.J=new ya(this.u,this.g.pa);this.Lc=new wa;this.Mc=new ya(null,this.Lc);Va(this,"connected",!1);Va(this,"authenticated",
!1);this.T=new Na;this.Vb=0}function rd(a){a=x(a.Lc,new n(".info/serverTimeOffset")).W()||0;return(new Date).getTime()+a}function Wa(a){a=a={timestamp:rd(a)};a.timestamp=a.timestamp||(new Date).getTime();return a}function Va(a,b,c){b=new n("/.info/"+b);E(a.Lc,b,J(c));O(a.Mc,b,[b])}function Ae(a){a.e("onDisconnectEvents");var b=[],c=Wa(a);Wb(se(a.T,c),new n(""),function(c,e){var f=Ua(a.J,c,e,a.g.M);b.push.apply(b,a.g.set(c,f));f=dc(a,c);W(a,f);O(a.J,f,[c])});pb(a.g,b);a.T=new Na}function sd(a,b,c,
d){var e=J(c);$c(a.u,b.toString(),e.W(!0),function(c,g){"ok"===c&&va(a.T,b,e);P(d,c,g)})}function Be(a,b,c,d,e){var f=J(c,d);$c(a.u,b.toString(),f.W(!0),function(c,d){"ok"===c&&va(a.T,b,f);P(e,c,d)})}function Ce(a,b,c,d){var e=!0,f;for(f in c)e=!1;e?(H("onDisconnect().update() called with empty data.  Don't do anything."),P(d,"ok")):me(a.u,b.toString(),c,function(e,f){if("ok"===e)for(var g in c){var k=J(c[g]);va(a.T,b.H(g),k)}P(d,e,f)})}function td(a){ua(a.fa,"deprecated_on_disconnect");a.Dd.ad.deprecated_on_disconnect=
!0}function P(a,b,c){a&&sa(function(){if("ok"==b)a(null,c);else{var d=(b||"error").toUpperCase(),e=d;c&&(e+=": "+c);e=Error(e);e.code=d;a(e)}})}function De(a,b,c,d,e){function f(){}a.e("transaction on "+b);var g=new k(a,b);g.hb("value",f);c={path:b,update:c,F:d,status:null,td:mb(),Ac:e,yd:0,xc:function(){g.Ab("value",f)},yc:null};a.Ha.aa=ud(a,a.Ha.aa,a.g.M.aa,a.Va);d=c.update(x(a.Ha,b).W());if(u(d)){ab("transaction failed: Data returned ",d);c.status=1;e=w(a.Va,b);var h=e.j()||[];h.push(c);Q(e,h);
h="object"===typeof d&&null!==d&&F(d,".priority")?d[".priority"]:x(a.g.M,b).k();e=Wa(a);d=J(d,h);d=Qa(d,e);E(a.Ha,b,d);c.Ac&&(E(a.g.pa,b,d),O(a.J,b,[b]));tb(a)}else c.xc(),c.F&&(a=vd(a,b),c.F(null,!1,a))}function tb(a,b){var c=b||a.Va;b||ub(a,c);if(null!==c.j()){var d=wd(a,c);p(0<d.length);Ee(d,function(a){return 1===a.status})&&Fe(a,c.path(),d)}else c.ub()&&c.A(function(b){tb(a,b)})}function Fe(a,b,c){for(var d=0;d<c.length;d++)p(1===c[d].status,"tryToSendTransactionQueue_: items in queue should all be run."),
c[d].status=2,c[d].yd++;var e=x(a.g.M,b).hash();E(a.g.M,b,x(a.g.pa,b));for(var f=x(a.Ha,b).W(!0),g=mb(),h=Ge(c),d=0;d<h.length;d++)Q(w(a.g.Hb,h[d]),g);a.u.put(b.toString(),f,function(e){a.e("transaction put response",{path:b.toString(),status:e});for(d=0;d<h.length;d++){var f=w(a.g.Hb,h[d]),k=f.j();p(null!==k,"sendTransactionQueue_: pendingPut should not be null.");k===g&&(Q(f,null),E(a.g.M,h[d],x(a.g.va,h[d])))}if("ok"===e){e=[];for(d=0;d<c.length;d++)c[d].status=3,c[d].F&&(f=vd(a,c[d].path),e.push(v(c[d].F,
null,null,!0,f))),c[d].xc();ub(a,w(a.Va,b));tb(a);for(d=0;d<e.length;d++)sa(e[d])}else{if("datastale"===e)for(d=0;d<c.length;d++)c[d].status=4===c[d].status?5:1;else{D("transaction at "+b+" failed: "+e);for(d=0;d<c.length;d++)c[d].status=5,c[d].yc=e}e=W(a,b);O(a.J,e,[b])}},e)}function Ge(a){for(var b={},c=0;c<a.length;c++)a[c].Ac&&(b[a[c].path.toString()]=a[c].path);a=[];for(var d in b)a.push(b[d]);return a}function W(a,b){var c=xd(a,b),d=c.path(),c=wd(a,c);E(a.g.pa,d,x(a.g.M,d));E(a.Ha,d,x(a.g.M,
d));if(0!==c.length){for(var e=x(a.g.pa,d),f=e,g=[],h=0;h<c.length;h++){var l=mc(d,c[h].path),t=!1,q;p(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===c[h].status)t=!0,q=c[h].yc;else if(1===c[h].status)if(25<=c[h].yd)t=!0,q="maxretry";else{var n=e.L(l),ta=c[h].update(n.W());if(u(ta)){ab("transaction failed: Data returned ",ta);var s=J(ta);"object"===typeof ta&&null!=ta&&F(ta,".priority")||(s=s.Ia(n.k()));e=e.Aa(l,s);c[h].Ac&&(f=f.Aa(l,s))}else t=!0,q="nodata"}t&&(c[h].status=
3,setTimeout(c[h].xc,Math.floor(0)),c[h].F&&(t=new k(a,c[h].path),l=new r(e.L(l),t),"nodata"===q?g.push(v(c[h].F,null,null,!1,l)):g.push(v(c[h].F,null,Error(q),!1,l))))}E(a.Ha,d,e);E(a.g.pa,d,f);ub(a,a.Va);for(h=0;h<g.length;h++)sa(g[h]);tb(a)}return d}function xd(a,b){for(var c,d=a.Va;null!==(c=G(b))&&null===d.j();)d=w(d,c),b=T(b);return d}function wd(a,b){var c=[];yd(a,b,c);c.sort(function(a,b){return a.td-b.td});return c}function yd(a,b,c){var d=b.j();if(null!==d)for(var e=0;e<d.length;e++)c.push(d[e]);
b.A(function(b){yd(a,b,c)})}function ub(a,b){var c=b.j();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d;Q(b,0<c.length?c:null)}b.A(function(b){ub(a,b)})}function dc(a,b){var c=xd(a,b).path(),d=w(a.Va,b);cb(d,function(a){ec(a)});ec(d);Ca(d,function(a){ec(a)});return c}function ec(a){var b=a.j();if(null!==b){for(var c=[],d=-1,e=0;e<b.length;e++)4!==b[e].status&&(2===b[e].status?(p(d===e-1,"All SENT items should be at beginning of queue."),d=e,b[e].status=4,b[e].yc=
"set"):(p(1===b[e].status),b[e].xc(),b[e].F&&c.push(v(b[e].F,null,Error("set"),!1,null))));-1===d?Q(a,null):b.length=d+1;for(e=0;e<c.length;e++)sa(c[e])}}function vd(a,b){var c=new k(a,b);return new r(x(a.Ha,b),c)}function ud(a,b,c,d){if(d.f())return c;if(null!=d.j())return b;var e=c;d.A(function(d){var g=d.name(),h=new n(g);d=ud(a,b.L(h),c.L(h),d);e=e.I(g,d)});return e}function K(){this.kb={}}function A(a,b,c){this.Lb=a;this.Y=b;this.Fa=c}function k(a,b){var c,d;if(a instanceof cc)c=a,d=b;else{q("new Firebase",
1,2,arguments.length);var e=arguments[0];d=c="";var f=!0,g="";if(B(e)){var h=e.indexOf("//");if(0<=h)var k=e.substring(0,h-1),e=e.substring(h+2);h=e.indexOf("/");-1===h&&(h=e.length);c=e.substring(0,h);var e=e.substring(h+1),l=c.split(".");if(3==l.length){h=l[2].indexOf(":");f=0<=h?"https"===k||"wss"===k:!0;if("firebase"===l[1])zc(c+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");else{d=l[0];g="";e=("/"+e).split("/");for(h=0;h<e.length;h++)if(0<e[h].length){l=e[h];try{l=
decodeURIComponent(l.replace(/\+/g," "))}catch(r){}g+="/"+l}}d=d.toLowerCase()}else zc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com")}f||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&D("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");c=new Ib(c,f,d,"ws"===k||"wss"===k);d=new n(g);f=d.toString();!(k=!B(c.host)||0===c.host.length||!Bb(c.bc))&&(k=0!==
f.length)&&(f&&(f=f.replace(/^\/*\.info(\/|$)/,"/")),k=!(B(f)&&0!==f.length&&!kc.test(f)));if(k)throw Error(M("new Firebase",1,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".');if(b)if(b instanceof K)f=b;else throw Error("Expected a valid Firebase.Context for second argument to new Firebase()");else f=K.tb();k=c.toString();(e=$(f.kb,k))||(e=new cc(c),f.kb[k]=e);c=e}s.call(this,c,d)}function yc(a,b){p(!b||!0===a||!1===a,"Can't turn on custom loggers persistently.");
!0===a?("undefined"!==typeof console&&("function"===typeof console.log?fa=v(console.log,console):"object"===typeof console.log&&(fa=function(a){console.log(a)})),b&&Kb.set("logging_enabled",!0)):a?fa=a:(fa=null,Kb.remove("logging_enabled"))}var g,Xa=this,yb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Kd=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,Nd={},Ld={},Md=/[\[\].#$\/\u0000-\u001F\u007F]/,kc=/[\[\].#$\u0000-\u001F\u007F]/;
s.prototype.Wc=function(){q("Query.ref",0,0,arguments.length);return new k(this.m,this.path)};s.prototype.ref=s.prototype.Wc;s.prototype.hb=function(a,b){q("Query.on",2,4,arguments.length);Cb("Query.on",a,!1);y("Query.on",2,b,!1);var c=lc("Query.on",arguments[2],arguments[3]);this.m.Tb(this,a,b,c.cancel,c.Z);return b};s.prototype.on=s.prototype.hb;s.prototype.Ab=function(a,b,c){q("Query.off",0,3,arguments.length);Cb("Query.off",a,!0);y("Query.off",2,b,!0);hc("Query.off",3,c);this.m.pc(this,a,b,c)};
s.prototype.off=s.prototype.Ab;s.prototype.$d=function(a,b){function c(g){f&&(f=!1,e.Ab(a,c),b.call(d.Z,g))}q("Query.once",2,4,arguments.length);Cb("Query.once",a,!1);y("Query.once",2,b,!1);var d=lc("Query.once",arguments[2],arguments[3]),e=this,f=!0;this.hb(a,c,function(b){e.Ab(a,c);d.cancel&&d.cancel.call(d.Z,b)})};s.prototype.once=s.prototype.$d;s.prototype.Td=function(a){q("Query.limit",1,1,arguments.length);if(!Aa(a)||Math.floor(a)!==a||0>=a)throw"Query.limit: First argument must be a positive integer.";
return new s(this.m,this.path,a,this.ea,this.ya,this.Ca,this.Za)};s.prototype.limit=s.prototype.Td;s.prototype.Cd=function(a,b){q("Query.startAt",0,2,arguments.length);pa("Query.startAt",1,a,!0);Db("Query.startAt",b);u(a)||(b=a=null);return new s(this.m,this.path,this.Ea,a,b,this.Ca,this.Za)};s.prototype.startAt=s.prototype.Cd;s.prototype.jd=function(a,b){q("Query.endAt",0,2,arguments.length);pa("Query.endAt",1,a,!0);Db("Query.endAt",b);return new s(this.m,this.path,this.Ea,this.ea,this.ya,a,b)};
s.prototype.endAt=s.prototype.jd;s.prototype.Nd=function(a,b){q("Query.equalTo",1,2,arguments.length);pa("Query.equalTo",1,a,!1);Db("Query.equalTo",b);return this.Cd(a,b).jd(a,b)};s.prototype.equalTo=s.prototype.Nd;s.prototype.Sa=function(){var a=Mb(Eb(this));return"{}"===a?"default":a};g=n.prototype;g.toString=function(){for(var a="",b=this.V;b<this.o.length;b++)""!==this.o[b]&&(a+="/"+this.o[b]);return a||"/"};g.parent=function(){if(this.V>=this.o.length)return null;for(var a=[],b=this.V;b<this.o.length-
1;b++)a.push(this.o[b]);return new n(a,0)};g.H=function(a){for(var b=[],c=this.V;c<this.o.length;c++)b.push(this.o[c]);if(a instanceof n)for(c=a.V;c<a.o.length;c++)b.push(a.o[c]);else{a=a.split("/");for(c=0;c<a.length;c++)0<a[c].length&&b.push(a[c])}return new n(b,0)};g.f=function(){return this.V>=this.o.length};g.length=function(){return this.o.length-this.V};g.contains=function(a){var b=this.V,c=a.V;if(this.length()>a.length())return!1;for(;b<this.o.length;){if(this.o[b]!==a.o[c])return!1;++b;++c}return!0};
g=aa.prototype;g.j=function(){return this.C.value};g.ub=function(){return 0<this.C.Cc};g.f=function(){return null===this.j()&&!this.ub()};g.A=function(a){for(var b in this.C.children)a(new aa(b,this,this.C.children[b]))};g.path=function(){return new n(null===this.Gb?this.Fa:this.Gb.path()+"/"+this.Fa)};g.name=function(){return this.Fa};g.parent=function(){return this.Gb};g=ba.prototype;g.sa=function(a,b){return new ba(this.Wa,this.da.sa(a,b,this.Wa).K(null,null,!1,null,null))};g.remove=function(a){return new ba(this.Wa,
this.da.remove(a,this.Wa).K(null,null,!1,null,null))};g.get=function(a){for(var b,c=this.da;!c.f();){b=this.Wa(a,c.key);if(0===b)return c.value;0>b?c=c.left:0<b&&(c=c.right)}return null};g.f=function(){return this.da.f()};g.count=function(){return this.da.count()};g.zb=function(){return this.da.zb()};g.fb=function(){return this.da.fb()};g.Da=function(a){return this.da.Da(a)};g.Ta=function(a){return this.da.Ta(a)};g.bb=function(a){return new Pd(this.da,a)};g=qa.prototype;g.K=function(a,b,c,d,e){return new qa(null!=
a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)};g.count=function(){return this.left.count()+1+this.right.count()};g.f=function(){return!1};g.Da=function(a){return this.left.Da(a)||a(this.key,this.value)||this.right.Da(a)};g.Ta=function(a){return this.right.Ta(a)||a(this.key,this.value)||this.left.Ta(a)};g.zb=function(){return Gb(this).key};g.fb=function(){return this.right.f()?this.key:this.right.fb()};g.sa=function(a,b,c){var d,e;e=this;d=c(a,e.key);
e=0>d?e.K(null,null,null,e.left.sa(a,b,c),null):0===d?e.K(null,b,null,null,null):e.K(null,null,null,null,e.right.sa(a,b,c));return Hb(e)};g.remove=function(a,b){var c,d;c=this;if(0>b(a,c.key))c.left.f()||c.left.Q()||c.left.left.Q()||(c=qc(c)),c=c.K(null,null,null,c.left.remove(a,b),null);else{c.left.Q()&&(c=db(c));c.right.f()||c.right.Q()||c.right.left.Q()||(c=Fa(c),c.left.left.Q()&&(c=db(c),c=Fa(c)));if(0===b(a,c.key)){if(c.right.f())return Da;d=Gb(c.right);c=c.K(d.key,d.value,null,null,pc(c.right))}c=
c.K(null,null,null,null,c.right.remove(a,b))}return Hb(c)};g.Q=function(){return this.color};g=sc.prototype;g.K=function(){return this};g.sa=function(a,b){return new qa(a,b,null)};g.remove=function(){return this};g.count=function(){return 0};g.f=function(){return!0};g.Da=function(){return!1};g.Ta=function(){return!1};g.zb=function(){return null};g.fb=function(){return null};g.Q=function(){return!1};var Da=new sc;Ga.prototype.set=function(a,b){null==b?this.Xb.removeItem(this.lc+a):this.Xb.setItem(this.lc+
a,L(b))};Ga.prototype.get=function(a){a=this.Xb.getItem(this.lc+a);return null==a?null:zb(a)};Ga.prototype.remove=function(a){this.Xb.removeItem(this.lc+a)};Ga.prototype.qd=!1;Ha.prototype.set=function(a,b){null==b?delete this.pb[a]:this.pb[a]=b};Ha.prototype.get=function(a){return F(this.pb,a)?this.pb[a]:null};Ha.prototype.remove=function(a){delete this.pb[a]};Ha.prototype.qd=!0;var ca=tc("localStorage"),Kb=tc("sessionStorage");Ib.prototype.toString=function(){return(this.rc?"https://":"http://")+
this.host};X(eb,function(){this.qa=-1});eb.prototype.reset=function(){this.D[0]=1732584193;this.D[1]=4023233417;this.D[2]=2562383102;this.D[3]=271733878;this.D[4]=3285377520;this.vc=this.eb=0};eb.prototype.update=function(a,b){u(b)||(b=a.length);for(var c=b-this.qa,d=0,e=this.Bc,f=this.eb;d<b;){if(0==f)for(;d<=c;)fb(this,a,d),d+=this.qa;if(B(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,f==this.qa){fb(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.qa){fb(this,e);f=0;break}}this.eb=
f;this.vc+=b};var Y=Array.prototype,Pa=Y.forEach?function(a,b,c){Y.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},nb=Y.map?function(a,b,c){return Y.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=B(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},He=Y.reduce?function(a,b,c,d){d&&(b=v(b,d));return Y.reduce.call(a,b,c)}:function(a,b,c,d){var e=c;Pa(a,function(c,g){e=b.call(d,e,c,g,a)});return e},
Ee=Y.every?function(a,b,c){return Y.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0},ra;a:{var zd=Xa.navigator;if(zd){var Ad=zd.userAgent;if(Ad){ra=Ad;break a}}ra=""}var Ie=ea("Opera")||ea("OPR"),Bd=ea("Trident")||ea("MSIE"),Je=ea("Gecko")&&-1==ra.toLowerCase().indexOf("webkit")&&!(ea("Trident")||ea("MSIE")),Ke=-1!=ra.toLowerCase().indexOf("webkit");(function(){var a="",b;if(Ie&&Xa.opera)return a=Xa.opera.version,
"function"==za(a)?a():a;Je?b=/rv\:([^\);]+)(\)|;)/:Bd?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Ke&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(ra))?a[1]:"");return Bd&&(b=(b=Xa.document)?b.documentMode:void 0,b>parseFloat(a))?String(b):a})();var gb=null,Jb=null,mb=function(){var a=1;return function(){return a++}}(),fa=null,xc=!0,Td=/^-?\d{1,10}$/;g=ia.prototype;g.P=function(){return!0};g.k=function(){return this.ib};g.Ia=function(a){return new ia(this.G,a)};g.O=function(){return z};g.L=function(a){return null===
G(a)?this:z};g.ga=function(){return null};g.I=function(a,b){return(new I).I(a,b).Ia(this.ib)};g.Aa=function(a,b){var c=G(a);return null===c?b:this.I(c,z.Aa(T(a),b))};g.f=function(){return!1};g.dc=function(){return 0};g.W=function(a){return a&&null!==this.k()?{".value":this.j(),".priority":this.k()}:this.j()};g.hash=function(){var a="";null!==this.k()&&(a+="priority:"+Fc(this.k())+":");var b=typeof this.G,a=a+(b+":"),a="number"===b?a+Cc(this.G):a+this.G;return wc(a)};g.j=function(){return this.G};
g.toString=function(){return"string"===typeof this.G?this.G:'"'+this.G+'"'};g=I.prototype;g.P=function(){return!1};g.k=function(){return this.ib};g.Ia=function(a){return new I(this.n,a)};g.I=function(a,b){var c=this.n.remove(a);b&&b.f()&&(b=null);null!==b&&(c=c.sa(a,b));return b&&null!==b.k()?new Ka(c,null,this.ib):new I(c,this.ib)};g.Aa=function(a,b){var c=G(a);if(null===c)return b;var d=this.O(c).Aa(T(a),b);return this.I(c,d)};g.f=function(){return this.n.f()};g.dc=function(){return this.n.count()};
var Le=/^\d+$/;g=I.prototype;g.W=function(a){if(this.f())return null;var b={},c=0,d=0,e=!0;this.A(function(f,g){b[f]=g.W(a);c++;e&&Le.test(f)?d=Math.max(d,Number(f)):e=!1});if(!a&&e&&d<2*c){var f=[],g;for(g in b)f[g]=b[g];return f}a&&null!==this.k()&&(b[".priority"]=this.k());return b};g.hash=function(){var a="";null!==this.k()&&(a+="priority:"+Fc(this.k())+":");this.A(function(b,c){var d=c.hash();""!==d&&(a+=":"+b+":"+d)});return""===a?"":wc(a)};g.O=function(a){a=this.n.get(a);return null===a?z:
a};g.L=function(a){var b=G(a);return null===b?this:this.O(b).L(T(a))};g.ga=function(a){return oc(this.n,a)};g.ld=function(){return this.n.zb()};g.nd=function(){return this.n.fb()};g.A=function(a){return this.n.Da(a)};g.Hc=function(a){return this.n.Ta(a)};g.bb=function(){return this.n.bb()};g.toString=function(){var a="{",b=!0;this.A(function(c,d){b?b=!1:a+=", ";a+='"'+c+'" : '+d.toString()});return a+="}"};var z=new I;X(Ka,I);g=Ka.prototype;g.I=function(a,b){var c=this.O(a),d=this.n,e=this.xa;null!==
c&&(d=d.remove(a),e=e.remove({name:a,ka:c.k()}));b&&b.f()&&(b=null);null!==b&&(d=d.sa(a,b),e=e.sa({name:a,ka:b.k()},b));return new Ka(d,e,this.k())};g.ga=function(a,b){var c=oc(this.xa,{name:a,ka:b.k()});return c?c.name:null};g.A=function(a){return this.xa.Da(function(b,c){return a(b.name,c)})};g.Hc=function(a){return this.xa.Ta(function(b,c){return a(b.name,c)})};g.bb=function(){return this.xa.bb(function(a,b){return{key:a.name,value:b}})};g.ld=function(){return this.xa.f()?null:this.xa.zb().name};
g.nd=function(){return this.xa.f()?null:this.xa.fb().name};var Wd=Math.log(2);r.prototype.W=function(){q("Firebase.DataSnapshot.val",0,0,arguments.length);return this.C.W()};r.prototype.val=r.prototype.W;r.prototype.Od=function(){q("Firebase.DataSnapshot.exportVal",0,0,arguments.length);return this.C.W(!0)};r.prototype.exportVal=r.prototype.Od;r.prototype.H=function(a){q("Firebase.DataSnapshot.child",0,1,arguments.length);Aa(a)&&(a=String(a));bb("Firebase.DataSnapshot.child",a);var b=new n(a),c=this.oc.H(b);
return new r(this.C.L(b),c)};r.prototype.child=r.prototype.H;r.prototype.Kc=function(a){q("Firebase.DataSnapshot.hasChild",1,1,arguments.length);bb("Firebase.DataSnapshot.hasChild",a);var b=new n(a);return!this.C.L(b).f()};r.prototype.hasChild=r.prototype.Kc;r.prototype.k=function(){q("Firebase.DataSnapshot.getPriority",0,0,arguments.length);return this.C.k()};r.prototype.getPriority=r.prototype.k;r.prototype.forEach=function(a){q("Firebase.DataSnapshot.forEach",1,1,arguments.length);y("Firebase.DataSnapshot.forEach",
1,a,!1);if(this.C.P())return!1;var b=this;return this.C.A(function(c,d){return a(new r(d,b.oc.H(c)))})};r.prototype.forEach=r.prototype.forEach;r.prototype.ub=function(){q("Firebase.DataSnapshot.hasChildren",0,0,arguments.length);return this.C.P()?!1:!this.C.f()};r.prototype.hasChildren=r.prototype.ub;r.prototype.name=function(){q("Firebase.DataSnapshot.name",0,0,arguments.length);return this.oc.name()};r.prototype.name=r.prototype.name;r.prototype.dc=function(){q("Firebase.DataSnapshot.numChildren",
0,0,arguments.length);return this.C.dc()};r.prototype.numChildren=r.prototype.dc;r.prototype.Wc=function(){q("Firebase.DataSnapshot.ref",0,0,arguments.length);return this.oc};r.prototype.ref=r.prototype.Wc;ja.prototype.dd=function(a,b){for(var c=this.yb[a]||[],d=0;d<c.length;d++)c[d].ba.apply(c[d].Z,Array.prototype.slice.call(arguments,1))};ja.prototype.hb=function(a,b,c){Gc(this,a);this.yb[a]=this.yb[a]||[];this.yb[a].push({ba:b,Z:c});(a=this.md(a))&&b.apply(c,a)};ja.prototype.Ab=function(a,b,c){Gc(this,
a);a=this.yb[a]||[];for(var d=0;d<a.length;d++)if(a[d].ba===b&&(!c||c===a[d].Z)){a.splice(d,1);break}};X(jb,ja);wb(jb);jb.prototype.md=function(a){p("visible"===a,"Unknown event type: "+a);return[this.nb]};X(kb,ja);wb(kb);kb.prototype.md=function(a){p("online"===a,"Unknown event type: "+a);return[this.Eb]};Ic.prototype.get=function(){return Hc(this.qb)};Ob.prototype.get=function(){var a=this.Ld.get(),b=Hc(a);if(this.Zb)for(var c in this.Zb)b[c]-=this.Zb[c];this.Zb=a;return b};Jc.prototype.vd=function(){var a=
this.uc.get(),b={},c=!1,d;for(d in a)0<a[d]&&F(this.ad,d)&&(b[d]=a[d],c=!0);c&&(a=this.u,a.S&&(b={c:b},a.e("reportStats",b),a.Ga("s",b)));setTimeout(v(this.vd,this),Math.floor(6E5*Math.random()))};var Qb={},Rb={},vb=null;"undefined"!==typeof MozWebSocket?vb=MozWebSocket:"undefined"!==typeof WebSocket&&(vb=WebSocket);var Cd;R.prototype.open=function(a,b){this.ja=b;this.Xd=a;this.e("Websocket connecting to "+this.Xa);this.X=new vb(this.Xa);this.rb=!1;ca.set("previous_websocket_failure",!0);var c=this;
this.X.onopen=function(){c.e("Websocket connected.");c.rb=!0};this.X.onclose=function(){c.e("Websocket connection was disconnected.");c.X=null;c.Ra()};this.X.onmessage=function(a){if(null!==c.X)if(a=a.data,c.Ja+=a.length,ua(c.fa,"bytes_received",a.length),Sb(c),null!==c.frames)Kc(c,a);else{a:{p(null===c.frames,"We already have a frame buffer");if(6>=a.length){var b=Number(a);if(!isNaN(b)){c.cd=b;c.frames=[];a=null;break a}}c.cd=1;c.frames=[]}null!==a&&Kc(c,a)}};this.X.onerror=function(a){c.e("WebSocket error.  Closing connection.");
(a=a.message||a.data)&&c.e(a);c.Ra()}};R.prototype.start=function(){};R.isAvailable=function(){var a=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var b=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);b&&1<b.length&&4.4>parseFloat(b[1])&&(a=!0)}return!a&&null!==vb&&!Cd};R.responsesRequiredToBeHealthy=2;R.healthyTimeout=3E4;g=R.prototype;g.$b=function(){ca.remove("previous_websocket_failure")};g.send=function(a){Sb(this);a=L(a);this.Ka+=a.length;ua(this.fa,"bytes_sent",a.length);
a=Bc(a,16384);1<a.length&&this.X.send(String(a.length));for(var b=0;b<a.length;b++)this.X.send(a[b])};g.Ob=function(){this.Oa=!0;this.wb&&(clearInterval(this.wb),this.wb=null);this.X&&(this.X.close(),this.X=null)};g.Ra=function(){this.Oa||(this.e("WebSocket is closing itself"),this.Ob(),this.ja&&(this.ja(this.rb),this.ja=null))};g.close=function(){this.Oa||(this.e("WebSocket is being closed"),this.Ob())};g=lb.prototype;g.add=function(a,b){this.set[a]=null!==b?b:!0};g.contains=function(a){return F(this.set,
a)};g.get=function(a){return this.contains(a)?this.set[a]:void 0};g.remove=function(a){delete this.set[a]};g.f=function(){var a;a:{a=this.set;for(var b in a){a=!1;break a}a=!0}return a};g.count=function(){var a=this.set,b=0,c;for(c in a)b++;return b};g.keys=function(){var a=[];U(this.set,function(b,c){a.push(c)});return a};var Dd,Ed;La.prototype.open=function(a,b){this.fd=0;this.T=b;this.rd=new $d(a);this.Oa=!1;var c=this;this.La=setTimeout(function(){c.e("Timed out trying to connect.");c.Ra();c.La=
null},Math.floor(3E4));Rd(function(){if(!c.Oa){c.ma=new Mc(function(a,b,d,g,k){Lc(c,arguments);if(c.ma)if(c.La&&(clearTimeout(c.La),c.La=null),c.rb=!0,"start"==a)c.id=b,c.ud=d;else if("close"===a)b?(c.ma.sc=!1,ae(c.rd,b,function(){c.Ra()})):c.Ra();else throw Error("Unrecognized command received: "+a);},function(a,b){Lc(c,arguments);be(c.rd,a,b)},function(){c.Ra()},c.Sb);var a={start:"t"};a.ser=Math.floor(1E8*Math.random());c.ma.wc&&(a.cb=c.ma.wc);a.v="5";c.tc&&(a.s=c.tc);a=c.Sb(a);c.e("Connecting via long-poll to "+
a);Nc(c.ma,a,function(){})}})};La.prototype.start=function(){var a=this.ma,b=this.ud;a.Vd=this.id;a.Wd=b;for(a.zc=!0;Tb(a););a=this.id;b=this.ud;this.gb=document.createElement("iframe");var c={dframe:"t"};c.id=a;c.pw=b;this.gb.src=this.Sb(c);this.gb.style.display="none";document.body.appendChild(this.gb)};La.isAvailable=function(){return!Ed&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.ke)&&
(Dd||!0)};g=La.prototype;g.$b=function(){};g.Ob=function(){this.Oa=!0;this.ma&&(this.ma.close(),this.ma=null);this.gb&&(document.body.removeChild(this.gb),this.gb=null);this.La&&(clearTimeout(this.La),this.La=null)};g.Ra=function(){this.Oa||(this.e("Longpoll is closing itself"),this.Ob(),this.T&&(this.T(this.rb),this.T=null))};g.close=function(){this.Oa||(this.e("Longpoll is being closed."),this.Ob())};g.send=function(a){a=L(a);this.Ka+=a.length;ua(this.fa,"bytes_sent",a.length);a=Ab(a);a=vc(a,!0);
a=Bc(a,1840);for(var b=0;b<a.length;b++){var c=this.ma;c.Ib.push({ee:this.fd,ie:a.length,hd:a[b]});c.zc&&Tb(c);this.fd++}};Mc.prototype.close=function(){this.zc=!1;if(this.$){this.$.Ba.body.innerHTML="";var a=this;setTimeout(function(){null!==a.$&&(document.body.removeChild(a.$),a.$=null)},Math.floor(0))}var b=this.ja;b&&(this.ja=null,b())};var fe=[La,R];V.prototype.Ad=function(a){Wc(this,{t:"d",d:a})};V.prototype.gc=function(a){Tc(this);this.Rc(a)};V.prototype.close=function(){2!==this.na&&(this.e("Closing realtime connection."),
this.na=2,Sc(this),this.T&&(this.T(),this.T=null))};var je=0,pe=0;g=ka.prototype;g.Ga=function(a,b,c){var d=++this.de;a={r:d,a:a,b:b};this.e(L(a));p(this.S,"sendRequest_ call when we're not connected not allowed.");this.la.Ad(a);c&&(this.Mb[d]=c)};g.ob=function(a,b,c){this.Ma={Md:a,kd:!1,ba:b,Ub:c};this.e("Authenticating using credential: "+this.Ma);Yc(this);if(!(b=40==a.length))a:{var d;try{var e=a.split(".");if(3!==e.length){b=!1;break a}var f;b:{try{if("undefined"!==typeof atob){f=atob(e[1]);break b}}catch(g){H("base64DecodeIfNativeSupport failed: ",
g)}f=null}null!==f&&(d=zb(f))}catch(h){H("isAdminAuthToken_ failed",h)}b="object"===typeof d&&!0===$(d,"admin")}b&&(this.e("Admin auth credential detected.  Reducing max reconnect time."),this.ac=3E4)};g.Rb=function(a){delete this.Ma;this.Bb(!1);this.S&&this.Ga("unauth",{},function(b){a(b.s,b.d)})};g.Pc=function(a,b){this.S?ob(this,"oc",a,null,b):this.Cb.push({Uc:a,action:"oc",data:null,F:b})};g.put=function(a,b,c,d){ad(this,"p",a,b,c,d)};g.gc=function(a){if("r"in a){this.e("from server: "+L(a));
var b=a.r,c=this.Mb[b];c&&(delete this.Mb[b],c(a.b))}else{if("error"in a)throw"A server-side error has occurred: "+a.error;"a"in a&&(b=a.a,c=a.b,this.e("handleServerMessage",b,c),"d"===b?this.hc(c.p,c.d,!1):"m"===b?this.hc(c.p,c.d,!0):"c"===b?qe(this,c.p,c.q):"ac"===b?(a=c.s,b=c.d,c=this.Ma,delete this.Ma,c&&c.Ub&&c.Ub(a,b),this.Bb(!1)):"sd"===b?this.Xc?this.Xc(c):"msg"in c&&"undefined"!==typeof console&&console.log("FIREBASE: "+c.msg.replace("\n","\nFIREBASE: ")):Lb("Unrecognized action received from server: "+
L(b)+"\nAre you using the latest client?"))}};g.Db=function(a){this.e("connection ready");this.S=!0;this.xb=(new Date).getTime();this.Sc({serverTimeOffset:a-(new Date).getTime()});Yc(this);for(var b in this.ia)for(var c in this.ia[b])a=this.ia[b][c],Xc(this,b,c,a.jb,a.F);for(b=0;b<this.U.length;b++)this.U[b]&&bd(this,b);for(;this.Cb.length;)b=this.Cb.shift(),ob(this,b.action,b.Uc,b.data,b.F);this.fc(!0)};g.Zd=function(a){a&&!this.nb&&this.ua===this.ac&&(this.e("Window became visible.  Reducing delay."),
this.ua=1E3,this.la||Ma(this,0));this.nb=a};g.Yd=function(a){a?(this.e("Browser went online.  Reconnecting."),this.ua=1E3,this.Ua=!0,this.la||Ma(this,0)):(this.e("Browser went offline.  Killing connection; don't reconnect."),this.Ua=!1,this.la&&this.la.close())};g.sd=function(){this.e("data client disconnected");this.S=!1;this.la=null;for(var a=0;a<this.U.length;a++){var b=this.U[a];b&&"h"in b.wd&&b.ae&&(b.F&&b.F("disconnect"),delete this.U[a],this.Fb--)}0===this.Fb&&(this.U=[]);if(this.Ua)this.nb?
this.xb&&(3E4<(new Date).getTime()-this.xb&&(this.ua=1E3),this.xb=null):(this.e("Window isn't visible.  Delaying reconnect."),this.ua=this.ac,this.Nc=(new Date).getTime()),a=Math.max(0,this.ua-((new Date).getTime()-this.Nc)),a*=Math.random(),this.e("Trying to reconnect in "+a+"ms"),Ma(this,a),this.ua=Math.min(this.ac,1.3*this.ua);else for(var c in this.Mb)delete this.Mb[c];this.fc(!1)};g.Na=function(){this.Ua=!1;this.la?this.la.close():(this.$a&&(clearTimeout(this.$a),this.$a=null),this.S&&this.sd())};
g.lb=function(){this.Ua=!0;this.ua=1E3;this.S||Ma(this,0)};Na.prototype.A=function(a){null!==this.n&&S(this.n,function(b,c){a(b,c)})};wa.prototype.toString=function(){return this.aa.toString()};cd.prototype.set=function(a,b){var c=this,d=[];Pa(b,function(a){var b=a.path;a=a.ta;var g=mb();Q(w(c.Hb,b),g);E(c.M,b,a);d.push({path:b,fe:g})});return d};ed.prototype.Kb=function(){for(var a=0;a<this.ab.length;a++)if(this.ab[a]){var b=this.ab[a];this.ab[a]=null;te(b)}this.ab=[]};xa.prototype.mc=function(a,
b){b=this.nc(a,b);null!=b&&id(this,b)};xa.prototype.Kb=function(){this.Gc.Kb()};X(qb,xa);qb.prototype.nc=function(a,b){this.i=a;this.vb&&null!=b&&b.push(new C("value",this.i));return b};qb.prototype.sb=function(){return{}};X($b,lb);g=$b.prototype;g.setActive=function(a){this.za=a};g.defaultView=function(){return la(this)?this.get("default"):null};g.path=function(){return this.Y};g.toString=function(){return nb(this.keys(),function(a){return"default"===a?"{}":a}).join("$")};g.jb=function(){var a=[];
S(this,function(b,c){a.push(c.R)});return a};X(Ta,xa);Ta.prototype.nc=function(a,b){if(null===b)return b;var c=[],d=this.R;u(d.ea)&&(u(d.ya)&&null!=d.ya?c.push(function(a,b){var c=ga(b,d.ea);return 0<c||0===c&&0<=ha(a,d.ya)}):c.push(function(a,b){return 0<=ga(b,d.ea)}));u(d.Ca)&&(u(d.Za)?c.push(function(a,b){var c=ga(b,d.Ca);return 0>c||0===c&&0>=ha(a,d.Za)}):c.push(function(a,b){return 0>=ga(b,d.Ca)}));var e=null,f=null;if(u(this.R.Ea))if(u(this.R.ea)){if(e=ld(a,c,this.R.Ea,!1)){var g=a.O(e).k();
c.push(function(a,b){var c=ga(b,g);return 0>c||0===c&&0>=ha(a,e)})}}else if(f=ld(a,c,this.R.Ea,!0)){var h=a.O(f).k();c.push(function(a,b){var c=ga(b,h);return 0<c||0===c&&0<=ha(a,f)})}for(var k=[],l=[],q=[],r=[],n=0;n<b.length;n++){var p=b[n].ca,s=b[n].wa;switch(b[n].type){case "child_added":rb(c,p,s)&&(this.i=this.i.I(p,s),l.push(b[n]));break;case "child_removed":this.i.O(p).f()||(this.i=this.i.I(p,null),k.push(b[n]));break;case "child_changed":!this.i.O(p).f()&&rb(c,p,s)&&(this.i=this.i.I(p,s),
r.push(b[n]));break;case "child_moved":var w=!this.i.O(p).f(),v=rb(c,p,s);w?v?(this.i=this.i.I(p,s),q.push(b[n])):(k.push(new C("child_removed",this.i.O(p),p)),this.i=this.i.I(p,null)):v&&(this.i=this.i.I(p,s),l.push(b[n]))}}var x=e||f;if(x){var y=(n=null!==f)?this.i.ld():this.i.nd(),z=!1,A=!1,B=this;(n?a.Hc:a.A).call(a,function(a,b){A||null!==y||(A=!0);if(A&&z)return!0;z?(k.push(new C("child_removed",B.i.O(a),a)),B.i=B.i.I(a,null)):A&&(l.push(new C("child_added",b,a)),B.i=B.i.I(a,b));y===a&&(A=!0);
a===x&&(z=!0)})}for(n=0;n<l.length;n++)c=l[n],p=this.i.ga(c.ca,c.wa),k.push(new C("child_added",c.wa,c.ca,p));for(n=0;n<q.length;n++)c=q[n],p=this.i.ga(c.ca,c.wa),k.push(new C("child_moved",c.wa,c.ca,p));for(n=0;n<r.length;n++)c=r[n],p=this.i.ga(c.ca,c.wa),k.push(new C("child_changed",c.wa,c.ca,p));this.vb&&0<k.length&&k.push(new C("value",this.i));return k};Ta.prototype.Kc=function(a){return this.i.O(a)!==z};Ta.prototype.sb=function(a,b,c){var d={};this.i.P()||this.i.A(function(a){d[a]=3});var e=
this.i;c=x(c,new n(""));var f=new aa;Q(w(f,this.R.path),!0);b=z.Aa(a,b);var g=this;jd(c,b,a,f,function(a,b,c){null!==c&&a.toString()===g.R.path.toString()&&g.nc(b,c)});this.i.P()?U(d,function(a,b){d[b]=2}):(this.i.A(function(a){F(d,a)||(d[a]=1)}),U(d,function(a,b){g.i.O(b).f()&&(d[b]=2)}));this.i=e;return d};ya.prototype.Tb=function(a,b,c,d,e){var f=a.path,g=w(this.oa,f),h=g.j();null===h?(h=new $b,Q(g,h)):p(!h.f(),"We shouldn't be storing empty QueryMaps");var k=a.Sa();if(h.contains(k))a=h.get(k),
gd(a,b,c,d,e);else{var l=this.g.aa.L(f);a="default"===a.Sa()?new qb(a,l):new Ta(a,l);ye(this,g,h,k,a);gd(a,b,c,d,e);(b=(b=cb(w(this.oa,f),function(a){var b;if(b=a.j()&&a.j().defaultView())b=a.j().defaultView().vb;if(b)return!0},!0))||null===this.u&&!x(this.g,f).f())&&Yb(a)}a.Kb()};ya.prototype.pc=function(a,b,c,d){var e=w(this.oa,a.path).j();return null===e?null:nd(this,e,a,b,c,d)};ya.prototype.mc=function(a,b,c){a=w(this.oa,a).j();null!==a&&S(a,function(a,e){e.mc(b,c)})};ya.prototype.sb=function(a,
b,c,d){function e(a){U(a,function(a,b){f[b]=3===a?3:($(f,b)||a)===a?a:3})}var f={};S(b,function(b,f){e(f.sb(a,c,d))});c.P()||c.A(function(a){F(f,a)||(f[a]=4)});return f};g=cc.prototype;g.toString=function(){return(this.N.rc?"https://":"http://")+this.N.host};g.name=function(){return this.N.bc};g.hc=function(a,b,c){this.Vb++;this.pd&&(b=this.pd(a,b));var d,e,f=[];9<=a.length&&a.lastIndexOf(".priority")===a.length-9?(d=new n(a.substring(0,a.length-9)),e=x(this.g.va,d).Ia(b),f.push(d)):c?(d=new n(a),
e=x(this.g.va,d),U(b,function(a,b){var c=new n(b);".priority"===b?e=e.Ia(a):(e=e.Aa(c,J(a)),f.push(d.H(b)))})):(d=new n(a),e=J(b),f.push(d));a=Ua(this.J,d,e,this.g.M);b=!1;for(c=0;c<a.length;++c){var g=a[c];b=re(this.g,g.path,g.ta)||b}b&&(d=W(this,d));O(this.J,d,f)};g.fc=function(a){Va(this,"connected",a);!1===a&&Ae(this)};g.Sc=function(a){var b=this;Nb(a,function(a,d){Va(b,d,a)})};g.Jc=function(a){a=new n(a);return x(this.g.va,a).hash()};g.Bb=function(a){Va(this,"authenticated",a)};g.ob=function(a,
b,c){"firebaseio-demo.com"===this.N.domain&&D("FirebaseRef.auth() not supported on demo (*.firebaseio-demo.com) Firebases. Please use on production (*.firebaseio.com) Firebases only.");this.u.ob(a,function(a,c){P(b,a,c)},function(a,b){D("auth() was canceled: "+b);if(c){var f=Error(b);f.code=a.toUpperCase();c(f)}})};g.Rb=function(a){this.u.Rb(function(b,c){P(a,b,c)})};g.mb=function(a,b,c,d){this.e("set",{path:a.toString(),value:b,ka:c});var e=Wa(this);b=J(b,c);var e=Qa(b,e),e=Ua(this.J,a,e,this.g.M),
f=this.g.set(a,e),g=this;this.u.put(a.toString(),b.W(!0),function(b,c){"ok"!==b&&D("set at "+a+" failed: "+b);pb(g.g,f);Oa(g.g,a);var e=W(g,a);O(g.J,e,[]);P(d,b,c)});e=dc(this,a);W(this,e);O(this.J,e,[a])};g.update=function(a,b,c){this.e("update",{path:a.toString(),value:b});var d=x(this.g.pa,a),e=!0,f=[],g=Wa(this),h=[],k;for(k in b){var e=!1,l=J(b[k]),l=Qa(l,g),d=d.I(k,l),n=a.H(k);f.push(n);l=Ua(this.J,n,l,this.g.M);h=h.concat(this.g.set(a,l))}if(e)H("update() called with empty data.  Don't do anything."),
P(c,"ok");else{var p=this;ne(this.u,a.toString(),b,function(b,d){"ok"!==b&&D("update at "+a+" failed: "+b);pb(p.g,h);Oa(p.g,a);var e=W(p,a);O(p.J,e,[]);P(c,b,d)});b=dc(this,a);W(this,b);O(p.J,b,f)}};g.Yc=function(a,b,c){this.e("setPriority",{path:a.toString(),ka:b});var d=Wa(this),d=Xb(b,d),d=x(this.g.M,a).Ia(d),d=Ua(this.J,a,d,this.g.M),e=this.g.set(a,d),f=this;this.u.put(a.toString()+"/.priority",b,function(b,d){"permission_denied"===b&&D("setPriority at "+a+" failed: "+b);pb(f.g,e);Oa(f.g,a);var g=
W(f,a);O(f.J,g,[]);P(c,b,d)});b=W(this,a);O(f.J,b,[])};g.Pc=function(a,b){var c=this;this.u.Pc(a.toString(),function(d,e){"ok"===d&&Vb(c.T,a);P(b,d,e)})};g.Tb=function(a,b,c,d,e){".info"===G(a.path)?this.Mc.Tb(a,b,c,d,e):this.J.Tb(a,b,c,d,e)};g.pc=function(a,b,c,d){if(".info"===G(a.path))this.Mc.pc(a,b,c,d);else{b=this.J.pc(a,b,c,d);if(c=null!==b){c=this.g;d=a.path;for(var e=[],f=0;f<b.length;++f)e[f]=x(c.va,b[f]);E(c.va,d,z);for(f=0;f<b.length;++f)E(c.va,b[f],e[f]);c=Oa(c,d)}c&&(p(this.g.pa.aa===
this.J.ec,"We should have raised any outstanding events by now.  Else, we'll blow them away."),E(this.g.pa,a.path,x(this.g.M,a.path)),this.J.ec=this.g.pa.aa)}};g.Na=function(){this.u.Na()};g.lb=function(){this.u.lb()};g.Zc=function(a){if("undefined"!==typeof console){a?(this.uc||(this.uc=new Ob(this.fa)),a=this.uc.get()):a=this.fa.get();var b=He(Yd(a),function(a,b){return Math.max(b.length,a)},0),c;for(c in a){for(var d=a[c],e=c.length;e<b+2;e++)c+=" ";console.log(c+d)}}};g.$c=function(a){ua(this.fa,
a);this.Dd.ad[a]=!0};g.e=function(){H("r:"+this.u.id+":",arguments)};wb(K);K.prototype.Na=function(){for(var a in this.kb)this.kb[a].Na()};K.prototype.interrupt=K.prototype.Na;K.prototype.lb=function(){for(var a in this.kb)this.kb[a].lb()};K.prototype.resume=K.prototype.lb;var l={Rd:function(a){var b=I.prototype.hash;I.prototype.hash=a;var c=ia.prototype.hash;ia.prototype.hash=a;return function(){I.prototype.hash=b;ia.prototype.hash=c}}};l.hijackHash=l.Rd;l.Sa=function(a){return a.Sa()};l.queryIdentifier=
l.Sa;l.Ud=function(a){return a.m.u.ia};l.listens=l.Ud;l.be=function(a){return a.m.u.la};l.refConnection=l.be;l.Gd=ka;l.DataConnection=l.Gd;ka.prototype.sendRequest=ka.prototype.Ga;ka.prototype.interrupt=ka.prototype.Na;l.Hd=V;l.RealTimeConnection=l.Hd;V.prototype.sendRequest=V.prototype.Ad;V.prototype.close=V.prototype.close;l.Fd=Ib;l.ConnectionTarget=l.Fd;l.Pd=function(){Dd=Cd=!0};l.forceLongPolling=l.Pd;l.Qd=function(){Ed=!0};l.forceWebSockets=l.Qd;l.he=function(a,b){a.m.u.Xc=b};l.setSecurityDebugCallback=
l.he;l.Zc=function(a,b){a.m.Zc(b)};l.stats=l.Zc;l.$c=function(a,b){a.m.$c(b)};l.statsIncrementCounter=l.$c;l.Vb=function(a){return a.m.Vb};l.dataUpdateCount=l.Vb;l.Sd=function(a,b){a.m.pd=b};l.interceptServerData=l.Sd;A.prototype.cancel=function(a){q("Firebase.onDisconnect().cancel",0,1,arguments.length);y("Firebase.onDisconnect().cancel",1,a,!0);this.Lb.Pc(this.Y,a)};A.prototype.cancel=A.prototype.cancel;A.prototype.remove=function(a){q("Firebase.onDisconnect().remove",0,1,arguments.length);N("Firebase.onDisconnect().remove",
this.Y);y("Firebase.onDisconnect().remove",1,a,!0);sd(this.Lb,this.Y,null,a)};A.prototype.remove=A.prototype.remove;A.prototype.set=function(a,b){q("Firebase.onDisconnect().set",1,2,arguments.length);N("Firebase.onDisconnect().set",this.Y);oa("Firebase.onDisconnect().set",a,!1);y("Firebase.onDisconnect().set",2,b,!0);sd(this.Lb,this.Y,a,b)};A.prototype.set=A.prototype.set;A.prototype.mb=function(a,b,c){q("Firebase.onDisconnect().setWithPriority",2,3,arguments.length);N("Firebase.onDisconnect().setWithPriority",
this.Y);oa("Firebase.onDisconnect().setWithPriority",a,!1);pa("Firebase.onDisconnect().setWithPriority",2,b,!1);y("Firebase.onDisconnect().setWithPriority",3,c,!0);if(".length"===this.Fa||".keys"===this.Fa)throw"Firebase.onDisconnect().setWithPriority failed: "+this.Fa+" is a read-only object.";Be(this.Lb,this.Y,a,b,c)};A.prototype.setWithPriority=A.prototype.mb;A.prototype.update=function(a,b){q("Firebase.onDisconnect().update",1,2,arguments.length);N("Firebase.onDisconnect().update",this.Y);if(na(a)){for(var c=
{},d=0;d<a.length;++d)c[""+d]=a[d];a=c;D("Passing an Array to Firebase.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}jc("Firebase.onDisconnect().update",a);y("Firebase.onDisconnect().update",2,b,!0);Ce(this.Lb,this.Y,a,b)};A.prototype.update=A.prototype.update;var Me=function(){var a=0,b=[];return function(c){var d=c===a;a=c;for(var e=Array(8),f=7;0<=f;f--)e[f]=
"-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(c%64),c=Math.floor(c/64);p(0===c,"Cannot push at time == 0");c=e.join("");if(d){for(f=11;0<=f&&63===b[f];f--)b[f]=0;b[f]++}else for(f=0;12>f;f++)b[f]=Math.floor(64*Math.random());for(f=0;12>f;f++)c+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(b[f]);p(20===c.length,"NextPushId: Length should be 20.");return c}}();X(k,s);var Fd=k,Ya=["Firebase"],Z=Xa;Ya[0]in Z||!Z.execScript||Z.execScript("var "+
Ya[0]);for(var Za;Ya.length&&(Za=Ya.shift());)!Ya.length&&u(Fd)?Z[Za]=Fd:Z=Z[Za]?Z[Za]:Z[Za]={};k.prototype.name=function(){q("Firebase.name",0,0,arguments.length);return this.path.f()?null:this.path.V<this.path.o.length?this.path.o[this.path.o.length-1]:null};k.prototype.name=k.prototype.name;k.prototype.H=function(a){q("Firebase.child",1,1,arguments.length);if(Aa(a))a=String(a);else if(!(a instanceof n))if(null===G(this.path)){var b=a;b&&(b=b.replace(/^\/*\.info(\/|$)/,"/"));bb("Firebase.child",
b)}else bb("Firebase.child",a);return new k(this.m,this.path.H(a))};k.prototype.child=k.prototype.H;k.prototype.parent=function(){q("Firebase.parent",0,0,arguments.length);var a=this.path.parent();return null===a?null:new k(this.m,a)};k.prototype.parent=k.prototype.parent;k.prototype.root=function(){q("Firebase.ref",0,0,arguments.length);for(var a=this;null!==a.parent();)a=a.parent();return a};k.prototype.root=k.prototype.root;k.prototype.toString=function(){q("Firebase.toString",0,0,arguments.length);
var a;if(null===this.parent())a=this.m.toString();else{a=this.parent().toString()+"/";var b=this.name();a+=encodeURIComponent(String(b))}return a};k.prototype.toString=k.prototype.toString;k.prototype.set=function(a,b){q("Firebase.set",1,2,arguments.length);N("Firebase.set",this.path);oa("Firebase.set",a,!1);y("Firebase.set",2,b,!0);this.m.mb(this.path,a,null,b)};k.prototype.set=k.prototype.set;k.prototype.update=function(a,b){q("Firebase.update",1,2,arguments.length);N("Firebase.update",this.path);
if(na(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c;D("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}jc("Firebase.update",a);y("Firebase.update",2,b,!0);if(F(a,".priority"))throw Error("update() does not currently support updating .priority.");this.m.update(this.path,a,b)};k.prototype.update=k.prototype.update;k.prototype.mb=function(a,b,c){q("Firebase.setWithPriority",
2,3,arguments.length);N("Firebase.setWithPriority",this.path);oa("Firebase.setWithPriority",a,!1);pa("Firebase.setWithPriority",2,b,!1);y("Firebase.setWithPriority",3,c,!0);if(".length"===this.name()||".keys"===this.name())throw"Firebase.setWithPriority failed: "+this.name()+" is a read-only object.";this.m.mb(this.path,a,b,c)};k.prototype.setWithPriority=k.prototype.mb;k.prototype.remove=function(a){q("Firebase.remove",0,1,arguments.length);N("Firebase.remove",this.path);y("Firebase.remove",1,a,
!0);this.set(null,a)};k.prototype.remove=k.prototype.remove;k.prototype.transaction=function(a,b,c){q("Firebase.transaction",1,3,arguments.length);N("Firebase.transaction",this.path);y("Firebase.transaction",1,a,!1);y("Firebase.transaction",2,b,!0);if(u(c)&&"boolean"!=typeof c)throw Error(M("Firebase.transaction",3,!0)+"must be a boolean.");if(".length"===this.name()||".keys"===this.name())throw"Firebase.transaction failed: "+this.name()+" is a read-only object.";"undefined"===typeof c&&(c=!0);De(this.m,
this.path,a,b,c)};k.prototype.transaction=k.prototype.transaction;k.prototype.Yc=function(a,b){q("Firebase.setPriority",1,2,arguments.length);N("Firebase.setPriority",this.path);pa("Firebase.setPriority",1,a,!1);y("Firebase.setPriority",2,b,!0);this.m.Yc(this.path,a,b)};k.prototype.setPriority=k.prototype.Yc;k.prototype.push=function(a,b){q("Firebase.push",0,2,arguments.length);N("Firebase.push",this.path);oa("Firebase.push",a,!0);y("Firebase.push",2,b,!0);var c=rd(this.m),c=Me(c),c=this.H(c);"undefined"!==
typeof a&&null!==a&&c.set(a,b);return c};k.prototype.push=k.prototype.push;k.prototype.ja=function(){return new A(this.m,this.path,this.name())};k.prototype.onDisconnect=k.prototype.ja;k.prototype.ce=function(){D("FirebaseRef.removeOnDisconnect() being deprecated. Please use FirebaseRef.onDisconnect().remove() instead.");this.ja().remove();td(this.m)};k.prototype.removeOnDisconnect=k.prototype.ce;k.prototype.ge=function(a){D("FirebaseRef.setOnDisconnect(value) being deprecated. Please use FirebaseRef.onDisconnect().set(value) instead.");
this.ja().set(a);td(this.m)};k.prototype.setOnDisconnect=k.prototype.ge;k.prototype.ob=function(a,b,c){q("Firebase.auth",1,3,arguments.length);if(!B(a))throw Error(M("Firebase.auth",1,!1)+"must be a valid credential (a string).");y("Firebase.auth",2,b,!0);y("Firebase.auth",3,b,!0);this.m.ob(a,b,c)};k.prototype.auth=k.prototype.ob;k.prototype.Rb=function(a){q("Firebase.unauth",0,1,arguments.length);y("Firebase.unauth",1,a,!0);this.m.Rb(a)};k.prototype.unauth=k.prototype.Rb;k.goOffline=function(){q("Firebase.goOffline",
0,0,arguments.length);K.tb().Na()};k.goOnline=function(){q("Firebase.goOnline",0,0,arguments.length);K.tb().lb()};k.enableLogging=yc;k.ServerValue={TIMESTAMP:{".sv":"timestamp"}};k.SDK_VERSION="1.0.19";k.INTERNAL=l;k.Context=K})();
var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null;
navigator.mozGetUserMedia?(webrtcDetectedBrowser="firefox",RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),attachMediaStream=function(b,d){console.log("Attaching media stream");b.mozSrcObject=d;b.play()},reattachMediaStream=function(b,d){console.log("Reattaching media stream");b.mozSrcObject=d.mozSrcObject;b.play()},MediaStream.prototype.getVideoTracks=function(){return[]},
MediaStream.prototype.getAudioTracks=function(){return[]}):navigator.webkitGetUserMedia?(webrtcDetectedBrowser="chrome",RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(b,d){b.src=webkitURL.createObjectURL(d)},reattachMediaStream=function(b,d){b.src=d.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=
function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})):console.log("Browser does not appear to be WebRTC-capable");window.moz=!!navigator.mozGetUserMedia;
function WebrtcFirebase(b){var d=this;this.firebaseUrl=b.firebaseUrl;this.channel=b.channel;this.guid=b.guid;this.init=function(){function b(){try{var a=new n;h=k=e.createDataChannel("test",{reliable:!0});k.onopen=function(a){d.onOpen()};k.onmessage=function(f){if(f.data.size)a.receive(f.data,{});else if(2!=f.data.charCodeAt(0)){var b=JSON.parse(f.data);"file"===b.type?a.receive(f.data,{}):d.messageCallback&&d.messageCallback(b.message)}};k.onclose=function(){console.log("dc1 The Data Channel is Closed")}}catch(f){console.warn("No data channel (pc1)",
f)}}function p(){b();e.createOffer(function(a){e.setLocalDescription(a,function(){})},function(){console.warn("Couldn't create offer")})}function q(){console.log("Datachannel connected")}function r(a){console.log("onRemoveStream",a)}function s(a){}function t(a){}function u(a){}function x(a){c.setRemoteDescription(a);c.createAnswer(function(a){c.setLocalDescription(a)},function(){console.warn("No create answer")})}function n(){var a=[],f="",b=0,d=0;return{receive:function(c,e){if(moz)if(c.size){var g=
new window.FileReader;g.readAsDataURL(c);g.onload=function(a){v.SaveToDisk(a.target.result,f);if(e.onFileReceived)e.onFileReceived(f)}}else g=JSON.parse(c),g.fileName&&(f=g.fileName);if(!moz){c.packets&&(d=b=parseInt(c.packets));if(e.onFileProgress)e.onFileProgress({remaining:b--,length:d,received:d-b});a.push(c.message);if(c.last){v.SaveToDisk(a.join(""),c.name);if(e.onFileReceived)e.onFileReceived(c.name);a=[]}}}}}var g="",l={iceServers:[{url:"stun:23.21.150.121"}]},w={optional:[{DtlsSrtpKeyAgreement:!0}]},
e=new RTCPeerConnection(l,w),k=null;this.pc1=e;var h;d.sendMessage=function(a){return a?(new y).send({message:a}):!1};this.createLocalOffer=p;e.onicecandidate=function(a){null==a.candidate&&(g=JSON.stringify(e.localDescription),d.firebaseRef.set(g))};e.onconnection=q;e.onRemoveStream=r;e.onsignalingstatechange=s;e.oniceconnectionstatechange=t;e.onicegatheringstatechange=u;var c=new RTCPeerConnection(l,w),m=null;this.pc2=c;c.ondatachannel=function(a){var f=new n;h=m=a.channel||a;m.onopen=function(){d.onOpen()};
m.onmessage=function(a){if(a.data.size)f.receive(a.data,{});else{var c=JSON.parse(a.data);"file"===c.type?f.receive(a.data,{}):d.messageCallback&&d.messageCallback(c.message)}};m.onclose=function(){console.log("dc2 The Data Channel is Closed")}};c.onicecandidate=function(a){null==a.candidate&&(g=JSON.stringify(c.localDescription),d.firebaseRef.set(g))};c.onRemoveStream=r;c.onsignalingstatechange=s;c.oniceconnectionstatechange=t;c.onicegatheringstatechange=u;c.onaddstream=function(a){console.log("Got remote stream",
a);var f=new Audio;f.autoplay=!0;attachMediaStream(f,a.stream)};c.onconnection=q;var y=function(a){return{send:function(a){data=moz&&a.file?a.file:JSON.stringify(a);h&&h.send(data)}}},v={SaveToDisk:function(a,c){var b=document.createElement("a");b.href=a;b.target="_blank";b.download=c||a;var d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});b.dispatchEvent(d);(window.URL||window.webkitURL).revokeObjectURL(b.href)}};this.firebaseRef=new Firebase(this.firebaseUrl+"/wrtc_"+this.channel);
this.hostRef=new Firebase(this.firebaseUrl+"/wrtc_host_"+this.channel);this.guestRef=new Firebase(this.firebaseUrl+"/wrtc_guest_"+this.channel);this.hostRef.once("value",function(a){a.val()?(this.guestRef.set(this.guid),this.guestRef.onDisconnect().remove(),a=_.after(2,function(a){a.val()||this.reset()}.bind(this)),this.hostRef.on("value",a)):(this.hostRef.set(this.guid),this.hostRef.onDisconnect().remove(),a=_.after(2,function(a){(a=a.val())?a!=this.guid&&p():this.reset()}.bind(this)),this.guestRef.on("value",
a))}.bind(this));this.firebaseRef.onDisconnect().remove();l=_.after(2,function(a){if((a=a.val())&&a!=g)"offer"==JSON.parse(a).type?(a=new RTCSessionDescription(JSON.parse(a)),x(a)):(a=new RTCSessionDescription(JSON.parse(a)),e.setRemoteDescription(a))}.bind(this));this.firebaseRef.on("value",l)};this.reset=function(){this.firebaseRef.off();this.hostRef.off();this.guestRef.off();this.firebaseRef.remove();this.hostRef.remove();this.guestRef.remove();delete this.firebaseRef;delete this.hostRef;delete this.guestRef;
delete this.pc1;delete this.pc2;this.init()};this.init()}WebrtcFirebase.prototype=Object.create(Object.prototype);WebrtcFirebase.prototype.constructor=WebrtcFirebase;WebrtcFirebase.DEFAULT_OPTIONS={};
var demobo=demobo||{};
(function(f,q){"function"===typeof define&&define.amd?define(["underscore","backbone"],function(b,c){return q(b||f._,c||f.Backbone)}):q(_,Backbone)})(this,function(f,q){function b(a){Object.apply(this,arguments);f.defaults(a,b.DEFAULT_OPTIONS);this.options=a;this.targets={};this.add(a||{})}function c(a){Object.apply(this,arguments);this.guid=demobo.Utils.getDeviceID();this.type=a?a.type:"";this.channel=a?a.channel:"";this.firebaseUrl=demobo.discovery.options.firebaseUrl+"/communicationLayer"}function h(a){c.apply(this,
arguments);this.target=new Firebase(this.firebaseUrl+"/fb_"+this.channel);this.target.onDisconnect().remove();setTimeout(function(){this.onConnect&&this.onConnect.call(this);this.isHost()||this.rpc("_remoteSync",[])}.bind(this),50)}function g(a){c.apply(this,arguments);var d=demobo.discovery.getHostIPAddress(),b=a.port;this.target=new DemoboWebsocket({channel:this.channel,id:this.guid,isHost:this.isHost(),internalIP:d,port:b});this.isHost()&&(demobo.discovery.deviceInfo.port=b);this.target.socketonopen=
function(){this.onConnect&&this.onConnect.call(this);this.isHost()||this.rpc("_remoteSync",[])}.bind(this)}function k(a){c.apply(this,arguments);this.target=new Alljoyn({channel:this.channel,id:this.guid,isHost:this.isHost()});setTimeout(function(){this.onConnect&&this.onConnect.call(this);this.isHost()||this.rpc("_remoteSync",[])}.bind(this),1500)}function l(a){c.apply(this,arguments);this.target=window.parent;setTimeout(function(){this.onConnect&&this.onConnect.call(this);this.isHost()||this.rpc("_remoteSync",
[])}.bind(this),0)}function m(a){c.apply(this,arguments);this.target=io.connect("172.16.0.43:4000");this.target.emit("create",this.channel);setTimeout(function(){this.onConnect&&this.onConnect.call(this);this.isHost()||this.rpc("_remoteSync",[])}.bind(this),50)}function n(a){c.apply(this,arguments);this.target=new WebrtcFirebase({firebaseUrl:this.firebaseUrl,channel:this.channel,guid:this.guid});this.target.onOpen=function(){this.onConnect&&this.onConnect.call(this);this.isHost()||this.rpc("_remoteSync",
[])}.bind(this)}var p={};b.prototype=Object.create(Object.prototype);b.prototype.constructor=b;b.DEFAULT_OPTIONS={};b.prototype.add=function(a,d,c){c=c||function(){};d=d||function(){};if(!a.layers||!a.layers.length)this.remove(a),c.call(this);else{var b=a.layers[0].split(":"),b={type:b[0],port:b[1],channel:a.channelID};if("websocket"==b.type&&demobo.discovery.isHost()){var f=this.getKey(a),e=this.targets[f];if(e&&"websocket"==e.type){delete e.state;e.ping.call(e);return}}switch(b.type){case "webrtc":b.channel=
a.channelID+":"+a.connectionID;e=new n(b);break;case "firebase":e=new h(b);break;case "iframe":e=new l(b);break;case "socketio":e=new m(b);break;case "alljoyn":e=new k(b);break;case "websocket":e=new g(b)}if(e){this.remove(a);1==b.maxConnections&&(this.offMessage(),this.targets={});e.key=this.getKey(a);this.targets[e.key]=e;if(this.onMessageCallback)e.onMessage(this.onMessageCallback);e.onConnect=function(){e.ping.call(e)}.bind(this);e.onSuccess=function(){demobo.discovery.isHost()&&this.syncSet();
d()}.bind(this);setTimeout(function(){e.state||(delete demobo.discovery.deviceInfo.port,a.layers.shift(),this.add(a,d,c))}.bind(this),demobo.discovery.options.layerTimeout)}else console.log("Communication Layer set up fails")}};b.prototype.getKey=function(a){return a.host+a.guest||a.channelID+a.connectionID};b.prototype.remove=function(a){a=this.getKey(a);var d=this.targets[a];d&&(d.offMessage(),delete this.targets[a])};b.prototype.set=function(a,d){a&&(p[a]=d);f(this.targets).map(function(b){b.set(a,
d)})};b.prototype.get=function(a){return p[a]};b.prototype.syncSet=function(){f(p).map(function(a,d){this.set(d,a)}.bind(this))};b.prototype.rpc=function(a,d){f(this.targets).map(function(b){b.rpc(a,d)})};b.prototype.postMessage=function(a){f(this.targets).map(function(d){d.postMessage(a)})};b.prototype.onMessage=function(a){this.onMessageCallback=a;f(this.targets).map(function(d){d.onMessage(a)})};b.prototype.offMessage=function(){f(this.targets).map(function(a){a.offMessage()})};c.prototype=Object.create(Object.prototype);
c.prototype.constructor=c;c.DEFAULT_OPTIONS={};c.prototype.isHost=function(){return demobo.discovery.isHost()};c.prototype.ping=function(){setTimeout(function(){this.postMessage({method:"ping",key:this.key,from:this.guid})}.bind(this),500)};c.prototype.pings=function(a){a--;this.ping();0<a&&setTimeout(function(){this.pings.call(this,a)}.bind(this),100)};c.prototype.set=function(a,d){this.postMessage({method:"set",key:a,value:d,from:this.guid})};c.prototype.rpc=function(a,d){var b=JSON.stringify([a,
d]);this.postMessage({message:b,from:this.guid})};c.prototype.postMessage=function(a){};c.prototype.onMessage=function(a){};c.prototype.offMessage=function(){};c.prototype.handleMessageCallback=function(a,b){a&&this.guid!=a.from&&("ping"==a.method?a.key==this.key&&a.from!=this.guid&&!this.state&&(this.state=1,this.ping.call(this),this.onSuccess()):"set"==a.method?a.key&&(p[a.key]=a.value):a.message&&b(a.message))};h.prototype=Object.create(c.prototype);h.prototype.constructor=h;h.DEFAULT_OPTIONS=
{};h.prototype.postMessage=function(a){this.target.set(a)};h.prototype.onMessage=function(a){this.messageCallback=function(b){(b=b.val())&&this.handleMessageCallback(b,a)}.bind(this);this.target.on("value",this.messageCallback)};h.prototype.offMessage=function(){this.target.off("value",this.messageCallback)};g.prototype=Object.create(c.prototype);g.prototype.constructor=g;g.DEFAULT_OPTIONS={};g.prototype.postMessage=function(a){this.target.send(a)};g.prototype.onMessage=function(a){this.messageCallback=
function(b){this.handleMessageCallback(b,a)}.bind(this);this.target.onMessage(this.messageCallback)};g.prototype.offMessage=function(){this.target.offMessage()};g.prototype.set=function(a,b){};k.prototype=Object.create(c.prototype);k.prototype.constructor=k;k.DEFAULT_OPTIONS={};k.prototype.postMessage=function(a){this.target.send("message",a)};k.prototype.onMessage=function(a){this.messageCallback=function(b){this.handleMessageCallback(b,a)}.bind(this);this.target.on("message",this.messageCallback)};
k.prototype.offMessage=function(){this.target.off("message",this.messageCallback)};l.prototype=Object.create(c.prototype);l.prototype.constructor=l;l.DEFAULT_OPTIONS={};l.prototype.postMessage=function(a){this.target.postMessage(a,"*")};l.prototype.onMessage=function(a){this.messageCallback=function(b){this.handleMessageCallback(b.data,a)}.bind(this);window.addEventListener?window.addEventListener("message",this.messageCallback,!1):window.attachEvent("onmessage",this.messageCallback)};l.prototype.offMessage=
function(){window.removeEventListener?window.removeEventListener("message",this.messageCallback,!1):window.detachEvent("onmessage",this.messageCallback)};m.prototype=Object.create(c.prototype);m.prototype.constructor=m;m.DEFAULT_OPTIONS={};m.prototype.postMessage=function(a){this.target.emit("message",a)};m.prototype.onMessage=function(a){this.messageCallback=function(b){this.handleMessageCallback(b,a)}.bind(this);this.target.on("message",this.messageCallback)};m.prototype.offMessage=function(){this.target.off("message",
this.messageCallback)};n.prototype=Object.create(c.prototype);n.prototype.constructor=n;n.DEFAULT_OPTIONS={};n.prototype.postMessage=function(a){this.target.sendMessage&&this.target.sendMessage(a)};n.prototype.onMessage=function(a){this.messageCallback=function(b){this.handleMessageCallback(b,a)}.bind(this);this.target.messageCallback=this.messageCallback};n.prototype.offMessage=function(){delete this.target.messageCallback};demobo.CommunicationLayer=b;demobo.communicationLayer=new demobo.CommunicationLayer({});
return demobo.CommunicationLayer});
var demobo=demobo||{};
(function(){var a={S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},guid:function(){return a.S4()+a.S4()+"-"+a.S4()+"-"+a.S4()+"-"+a.S4()+"-"+a.S4()+a.S4()+a.S4()},getDeviceID:_.memoize(function(){return"undefined"!=typeof demobo_guid?demobo_guid:a.guid()}),isChrome:_.memoize(function(){return navigator.userAgent.match(/(Chrome)/)}),isMobile:_.memoize(function(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)}),isAndroid:_.memoize(function(){return navigator.userAgent.match(/(Android)/)}),isIOS:_.memoize(function(){return navigator.userAgent.match(/(iPhone|iPod|iPad)/)}),
generateCode:function(a){return Math.random().toString(36).substr(2,a)}};demobo.Utils=a})();
var demobo=demobo||{};
(function(){function b(a){Object.apply(this,arguments);_.defaults(a,b.DEFAULT_OPTIONS);this.options=a;k.call(this);this.initDeviceInfo.call(this);l.call(this)}function k(){this.pairingTimeout;this.onPairing=this.options.onPairing;this.onSuccess=function(){this.pairingTimeout&&clearTimeout(this.pairingTimeout);this.options.onSuccess()}.bind(this);this.onFailure=function(){this.pairingTimeout&&clearTimeout(this.pairingTimeout);this.options.onFailure()}.bind(this);this.onTimeout=function(){this.pairingTimeout&&
clearTimeout(this.pairingTimeout);this.options.onTimeout()}.bind(this);this.rootUrl=this.options.firebaseUrl+"/"+this.options.appName+"/";this.pairingUrl=this.options.firebaseUrl+"/"+this.options.appName+"/pairing/";this.enabled=!1;this.pairing={};this.pairing.candidates=[];this.pairing.pairedMembers=[];this.failCallback=this.successCallback=null;this.allowMesh=this.options.allowMesh}function l(){this.keydownHandler=function(a){32==a.keyCode&&setTimeout(this.onPairingTrigger.bind(this),2*m.delay)}.bind(this);
this.onPairHandler=function(a){a=a.val();_.each(a,function(a){this.pairing.candidates.push(a)}.bind(this))}.bind(this)}function f(a){this.removeTimeout&&clearTimeout(this.removeTimeout);this.removeTimeout=setTimeout(function(){this.pairingRef.off("child_added");this.pairingRef.off("value");this.pairingRef.child(this.getDeviceInfo().deviceID).remove()}.bind(this),a)}function g(){var a=_.find(this.pairing.candidates,function(a){return a.deviceID==this.getDeviceInfo().deviceID}.bind(this));a&&(this.pairing.pairedMembers=
this.pairing.candidates.filter(function(c){return c.deviceID==this.getDeviceInfo().deviceID?!1:"code"==this.options.method?c.code&&a.code==c.code:Math.abs(c.serverTime-a.serverTime)<=this.options.paringTolerance}.bind(this)),n.call(this,a));this.pairing.candidates=[]}function n(a){this.roomRef=null;if(1==this.pairing.pairedMembers.length){var c=this.pairing.pairedMembers[0];if(!c.channelID||!a.channelID)if((c.channelID||a.channelID)&&!c.isHost&&!a.isHost)this.allowMesh?p.call(this,a):this.failCallback(c.host?
c.host:a.host);else{c=this.pairing.pairedMembers[0];if(!(a.isHost&&!c.isHost||!a.isHost&&c.isHost)){var b=this.isMobile(),e=this.isAgentMobile(c.userAgent);e&&b||!e&&!b?this.getDeviceInfo().isHost=a.serverTime<=c.serverTime:e&&!b?this.getDeviceInfo().isHost=!0:!e&&b&&(this.getDeviceInfo().isHost=!1)}q.call(this,a)}}else this.roomRef&&this.failCallback("more then one device is pairing")}function p(a){var b="",b=a.channelID?this.pairing.pairedMembers[0].deviceID:a.deviceID;this.getDeviceInfo().roomId=
b;this.roomRef=new Firebase(this.rootUrl+"connected/"+b);this.roomRef.onDisconnect().remove();a.channelID?(a={},a.connectionID=demobo.Utils.guid(),a.host=this.getDeviceInfo().host,a.layers=this.getDeviceInfo().layers,a.channelID=this.getDeviceInfo().channelID,a.hostInfo=this.getDeviceInfo().hostInfo,a=_.compactObject(a),this.roomRef.update(a,function(){this.roomOnValue=function(a){if((a=a.val())&&a.guest)this.roomRef.off("value",this.roomOnValue),this.successCallback(a)}.bind(this);this.roomRef.on("value",
this.roomOnValue)}.bind(this))):h.call(this)}function q(a){var b="",b=this.getDeviceInfo().isHost?this.pairing.pairedMembers[0].deviceID:a.deviceID;this.getDeviceInfo().roomId=b;this.roomRef=new Firebase(this.rootUrl+"connected/"+b);this.roomRef.onDisconnect().remove();this.getDeviceInfo().isHost?(a={},this.getDeviceInfo().channelID||(this.getDeviceInfo().channelID=demobo.Utils.guid()),a.channelID=this.getDeviceInfo().channelID,a.connectionID=demobo.Utils.guid(),a.host=this.getDeviceInfo().deviceID,
a.hostInfo={},a.hostInfo.internalIP=this.getDeviceInfo().internalIP||"",a.hostInfo.userAgent=this.getDeviceInfo().userAgent||"",this.getDeviceInfo().hostInfo=a.hostInfo,a.layers=this.getDeviceInfo().layers,a=_.compactObject(a),this.roomRef.update(a,function(){this.roomOnValue=function(a){if((a=a.val())&&a.guest)this.roomRef.off("value",this.roomOnValue),this.successCallback(a)}.bind(this);this.roomRef.on("value",this.roomOnValue)}.bind(this))):h.call(this)}function h(){this.roomOnValue=function(a){if(a=
a.val())a.layers=_.intersection(a.layers,this.getDeviceInfo().layers),a.guest=this.getDeviceInfo().deviceID,this.roomRef.off("value",this.roomOnValue),this.getDeviceInfo().host=a.host,this.getDeviceInfo().channelID=a.channelID,this.getDeviceInfo().hostInfo=a.hostInfo,a=_.compactObject(a),this.roomRef.update(a),this.successCallback(a)}.bind(this);this.roomRef.on("value",this.roomOnValue)}function r(){this.pairingRef.off("child_added");this.pairingRef.off("value");if("code"==this.options.method&&this.isHost())this.pairingRef.on("child_added",
function(){setTimeout(function(){this.pairingRef.once("value",function(a){this.onPairHandler(a);g.call(this)}.bind(this))}.bind(this),this.options.paringTolerance)}.bind(this));else this.pairingRef.once("child_added",function(){setTimeout(function(){this.pairingRef.once("value",function(a){this.onPairHandler(a);g.call(this)}.bind(this))}.bind(this),this.options.paringTolerance)}.bind(this))}var m=demobo.SimpleBump;b.prototype=Object.create(Object.prototype);b.prototype.constructor=b;b.DEFAULT_OPTIONS=
{firebaseUrl:"https://demobo.firebaseio.com",appName:"discovery",paringTolerance:1E3,dataKeptTime:5E3,mode:"conference",isHost:!1,method:"bump",timeout:6E3,layerTimeout:3E3};b.prototype.initDeviceInfo=function(){this.deviceInfo={deviceID:demobo.Utils.getDeviceID(),platform:navigator.platform,userAgent:navigator.userAgent,layers:this.options.layers||this.getAvailableLayers(),isHost:this.options.isHost,roomId:null,channelID:null,host:null,externalID:demobo_r};this.isMobile()&&window.getIPAddress&&window.getIPAddress(!0,
function(a){_.extend(this.deviceInfo,{internalIP:a})}.bind(this),function(a){console.log(a)});this.options.alwaysOn&&this.deviceInfo.externalID&&setTimeout(function(){this.enable()}.bind(this),0)};b.prototype.enable=function(){this.enabled||(this.enabled=!0,"code"==this.options.method?this.startCodePairing():this.startBumpPairing())};b.prototype.disable=function(){this.enabled&&(this.enabled=!1,"code"==this.options.method?this.endCodePairing():this.endBumpPairing())};b.prototype.search=function(a,
b){"function"===typeof a&&(this.successCallback=_.debounce(a,300,!0));"function"===typeof b&&(this.failCallback=_.debounce(b,300,!0))};b.prototype.getDeviceInfo=function(){return this.deviceInfo};b.prototype.getDeviceID=function(){return this.deviceInfo.deviceID};b.prototype.isMobile=function(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)};b.prototype.isAgentMobile=function(a){return a.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)};b.prototype.getAvailableLayers=
function(){var a=["firebase"];a.unshift("websocket:8010");a.unshift("websocket:80");"undefined"!=typeof webrtcDetectedBrowser&&webrtcDetectedBrowser&&a.unshift("webrtc");this.isMobile()&&"undefined"!=typeof Alljoyn&&a.unshift("alljoyn");return a};b.prototype.isHost=function(){return this.getDeviceInfo().isHost};b.prototype.getIPAddress=function(){return this.getDeviceInfo().internalIP};b.prototype.getHostIPAddress=function(){return this.getDeviceInfo().hostInfo.internalIP};b.prototype.isServer=function(){return this.getDeviceInfo().hostInfo.internalIP===
this.getDeviceInfo().internalIP};b.prototype.getRoomID=function(){return this.deviceInfo.externalID.replace(/\./g,"dot")};b.prototype.onPairingTrigger=function(){r.call(this);var a=this.pairingRef;if(a){var b=_.compactObject(this.getDeviceInfo());b.serverTime=Firebase.ServerValue.TIMESTAMP;var d={};d[b.deviceID]=b;d=_.compactObject(d);a.update(d)}this.getDeviceInfo().isHost||f.call(this,this.options.dataKeptTime);this.onPairing&&(this.onPairing(),this.pairingTimeout=setTimeout(this.onTimeout,this.options.timeout))};
b.prototype.startBumpPairing=function(){if(this.deviceInfo.externalID){var a=this.pairingUrl+this.getRoomID();this.pairingRef=new Firebase(a);this.isMobile()?(this.onPairingTriggerRef=this.onPairingTrigger.bind(this),document.addEventListener("volumedownbutton",this.onPairingTriggerRef,!1),document.addEventListener("volumeupbutton",this.onPairingTriggerRef,!1)):window.addEventListener("keydown",this.keydownHandler)}};b.prototype.endBumpPairing=function(){f.call(this,0);this.isMobile()?(document.removeEventListener("volumedownbutton",
this.onPairingTriggerRef,!1),document.removeEventListener("volumeupbutton",this.onPairingTriggerRef,!1)):window.removeEventListener("keydown",this.keydownHandler)};b.prototype.startCodePairing=function(){if(this.deviceInfo.externalID){var a=this.pairingUrl+this.getRoomID();this.pairingRef=new Firebase(a);this.isMobile()&&this.enterCode(Math.random().toString(36).substr(2,4))}};b.prototype.endCodePairing=function(){f.call(this,0)};b.prototype.enterCode=function(a){this.deviceInfo.code=a;this.onPairingTrigger()};
demobo.Discovery=b})();
var demobo=demobo||{};(function(){demobo.init=function(a){Object.apply(this,arguments);demobo.discovery=new demobo.Discovery(a);demobo.discovery.search(function(a){a.channelID&&a.connectionID&&a.layers.length?demobo.communicationLayer.add(a,demobo.discovery.onSuccess,demobo.discovery.onFailure):(demobo.discovery.onFailure(),console.log("Connection failed: no channecl/layer available."))}.bind(this),function(a){demobo.discovery.onFailure();console.log("Connection failed: error ",a)})}})();
if("undefined"==typeof DemoboWebsocket){var DemoboWebsocket=function(a){this.channel=a.channel;this.id=a.id;this.isHost=a.isHost;this.port=a.port;this.internalIP=a.internalIP;setTimeout(this.init.bind(this),1E3)};DemoboWebsocket.prototype=Object.create(Object.prototype);DemoboWebsocket.prototype.constructor=DemoboWebsocket}
DemoboWebsocket.prototype.init=function(){this.socket=new WebSocket("ws://"+this.internalIP+":"+this.port);this.socket.onmessage=this.socketonmessage;this.socket.onopen=this.socketonopen;this.socket.onclose=this.socketonclose};DemoboWebsocket.prototype.send=function(a){this.socket.send(JSON.stringify(a))};DemoboWebsocket.prototype.onMessage=function(a){this.socketonmessage=function(b){a(JSON.parse(b.data))}};DemoboWebsocket.prototype.offMessage=function(){this.socket&&delete this.socket.onmessage};
_.mixin({compactObject:function(a){var b=_.clone(a);_.each(b,function(a,c){a||delete b[c]});return b}});
(function(e,d){"function"===typeof define&&define.amd?define(["underscore","backbone"],function(f,g){return d(f||e._,g||e.Backbone)}):d(_,Backbone)})(this,function(e,d){function f(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function g(a){return a&&JSON.parse(a)}var l=demobo.communicationLayer,m=l.rpc.bind(l),h={};(function(){function a(a,c){var d=new CustomEvent("storage");d.key=a;d.newValue=c;window.dispatchEvent(d)}function c(a){e(h).map(function(c){c.onStorage.call(c,a)})}l.onMessage.call(l,
function(b){b=g(b);var c=b[0],d=b[1][0];"_remoteSync"==c?d?(b=h[d])&&b.localStorage._remoteSync.call(b.localStorage):e(h).map(function(a){a.localStorage._remoteSync.call(a.localStorage)}):"_remoteSyncStart"==c?(b=h[d])&&b.localStorage._clear.call(b.localStorage):"_setItem"==c?(b=e.toArray(b[1]),1<e(l.targets).size()&&localStorage.__proto__.setItem.apply(localStorage,b)||localStorage.__proto__._setItem.apply(localStorage,b),a.apply(window,b)):"_removeItem"==c?(b=e.toArray(b[1]),1<e(l.targets).size()&&
localStorage.__proto__.removeItem.apply(localStorage,b)||localStorage.__proto__._removeItem.apply(localStorage,b),a.apply(window,b)):"_remoteSyncEnd"==c?(b=h[d])&&b.fetch.call(b):"_debug"==c&&console.log("_debug",b)});window.addEventListener?window.addEventListener("storage",c,!1):window.attachEvent("onstorage",c)})();d.DemoboStorage=function(a){this.name="DemoboStorage-"+a.name;this.restore()};e.extend(d.DemoboStorage.prototype,{restore:function(){var a=this.localStorage().getItem(this.name);this.records=
a&&a.split(",")||[]},save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(a){a.id||(a.id=f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f(),a.set(a.idAttribute,a.id));this.localStorage().setItem(this.name+"-"+a.id,JSON.stringify(a));this.records.push(a.id.toString());this.save();return this.find(a)},update:function(a){this.localStorage().setItem(this.name+"-"+a.id,JSON.stringify(a));e.include(this.records,a.id.toString())||this.records.push(a.id.toString());
this.save();return this.find(a)},find:function(a){return g(this.localStorage().getItem(this.name+"-"+a.id))},findAll:function(){return e(this.records).chain().map(function(a){return g(this.localStorage().getItem(this.name+"-"+a))},this).compact().value()},destroy:function(a){if(a.isNew())return!1;this.localStorage().removeItem(this.name+"-"+a.id);this.records=e.reject(this.records,function(c){return c===a.id.toString()});this.save();return a},localStorage:function(){return localStorage},_clear:function(){var a=
this.localStorage(),c=RegExp("^"+this.name+"-");a._removeItem(this.name);e.chain(a).keys().filter(function(a){return c.test(a)}).each(function(b){a._removeItem(b)})},_storageSize:function(){return this.localStorage().length},_remoteSync:function(){m("_remoteSyncStart",[this.name]);setTimeout(function(){var a=this.localStorage(),c=RegExp("^"+this.name+"-");m("_setItem",[this.name,a.getItem(this.name)]);e.chain(a).keys().filter(function(a){return c.test(a)}).each(function(b){m("_setItem",[b,a.getItem(b)])});
m("_remoteSyncEnd",[this.name])}.bind(this),1E3)}});d.DemoboStorage.sync=d.localSync=function(a,c,b){var e=c.localStorage||c.collection.localStorage,f,k,g=$.Deferred&&$.Deferred();try{switch(a){case "read":f=void 0!=c.id?e.find(c):e.findAll();break;case "create":f=e.create(c);break;case "update":f=e.update(c);break;case "delete":f=e.destroy(c)}}catch(h){k=h.code===DOMException.QUOTA_EXCEEDED_ERR&&0===e._storageSize()?"Private browsing is unsupported":h.message}f?(c.trigger("sync",c,f,b),b&&b.success&&
("0.9.10"===d.VERSION?b.success(c,f,b):b.success(f)),g&&g.resolve(f)):(k=k?k:"Record Not Found",c.trigger("error",c,k,b),b&&b.error&&("0.9.10"===d.VERSION?b.error(c,k,b):b.error(k)),g&&g.reject(k));b&&b.complete&&b.complete(f);return g&&g.promise()};d.ajaxSync=d.sync;d.getSyncMethod=function(a){return a.localStorage||a.collection&&a.collection.localStorage?d.localSync:d.ajaxSync};d.sync=function(a,c,b){return d.getSyncMethod(c).apply(this,[a,c,b])};localStorage.__proto__._setItem=localStorage.__proto__.setItem;
localStorage.__proto__.setItem=function(){var a=arguments[0],c=arguments[1];if(localStorage.getItem(a)==c)return!1;0==a.indexOf("DemoboStorage-")&&m("_setItem",arguments);localStorage.__proto__._setItem.apply(this,arguments);return!0};localStorage.__proto__._removeItem=localStorage.__proto__.removeItem;localStorage.__proto__.removeItem=function(){var a=arguments[0],c=arguments[1];if(localStorage.getItem(a)==c)return!1;0==a.indexOf("DemoboStorage-")&&m("_removeItem",arguments);localStorage.__proto__._removeItem.apply(this,
arguments);return!0};d.DemoboStorage.Collection=d.Collection.extend({initialize:function(){this.localStorage=new d.DemoboStorage({name:this.demoboID});h[this.localStorage.name]=this},handleStorageEvent:function(a,c){if(a===this.localStorage.name)this.localStorage.restore();else{var b=a.split(this.localStorage.name+"-")[1];b&&(c?(b=g(c),this.add.call(this,[b],{silent:!1,merge:!0})):(b=this.get(b))&&b.trigger("destroy",b,this))}},onStorage:function(a){var c=a.key;a=this.localStorage.localStorage().getItem(a.key);
this.handleStorageEvent.call(this,c,a)}});d.DemoboStorage.Model=d.Model.extend({initialize:function(){this.localStorage=new d.DemoboStorage({name:this.demoboID});h[this.localStorage.name]=this},handleStorageEvent:function(a,c){if(a===this.localStorage.name)this.localStorage.restore();else if(a.split(this.localStorage.name+"-")[1]==this.id)if(c){var b=g(c);this.save(b)}else this&&this.trigger("destroy",this,this)},onStorage:function(a){var c=a.key;a=this.localStorage.localStorage().getItem(a.key);
this.handleStorageEvent.call(this,c,a)}});return d.DemoboStorage});
